{"version":3,"sources":["test.js"],"names":[],"mappings":"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","file":"test-compiled.js","sourcesContent":["var test = require('tap').test\nvar inf = require('./inflight.js')\n\n\nfunction req (key, cb) {\n  cb = inf(key, cb)\n  if (cb) setTimeout(function () {\n    cb(key)\n    cb(key)\n  })\n  return cb\n}\n\ntest('basic', function (t) {\n  var calleda = false\n  var a = req('key', function (k) {\n    t.notOk(calleda)\n    calleda = true\n    t.equal(k, 'key')\n    if (calledb) t.end()\n  })\n  t.ok(a, 'first returned cb function')\n\n  var calledb = false\n  var b = req('key', function (k) {\n    t.notOk(calledb)\n    calledb = true\n    t.equal(k, 'key')\n    if (calleda) t.end()\n  })\n\n  t.notOk(b, 'second should get falsey inflight response')\n})\n\ntest('timing', function (t) {\n  var expect = [\n    'method one',\n    'start one',\n    'end one',\n    'two',\n    'tick',\n    'three'\n  ]\n  var i = 0\n\n  function log (m) {\n    t.equal(m, expect[i], m + ' === ' + expect[i])\n    ++i\n    if (i === expect.length)\n      t.end()\n  }\n\n  function method (name, cb) {\n    log('method ' + name)\n    process.nextTick(cb)\n  }\n\n  var one = inf('foo', function () {\n    log('start one')\n    var three = inf('foo', function () {\n      log('three')\n    })\n    if (three) method('three', three)\n    log('end one')\n  })\n\n  method('one', one)\n\n  var two = inf('foo', function () {\n    log('two')\n  })\n  if (two) method('one', two)\n\n  process.nextTick(log.bind(null, 'tick'))\n})\n\ntest('parameters', function (t) {\n  t.plan(8)\n\n  var a = inf('key', function (first, second, third) {\n    t.equal(first, 1)\n    t.equal(second, 2)\n    t.equal(third, 3)\n  })\n  t.ok(a, 'first returned cb function')\n\n  var b = inf('key', function (first, second, third) {\n    t.equal(first, 1)\n    t.equal(second, 2)\n    t.equal(third, 3)\n  })\n  t.notOk(b, 'second should get falsey inflight response')\n\n  setTimeout(function () {\n    a(1, 2, 3)\n  })\n})\n"]}