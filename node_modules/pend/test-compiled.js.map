{"version":3,"sources":["test.js"],"names":[],"mappings":"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","file":"test-compiled.js","sourcesContent":["var assert = require('assert');\nvar Pend = require('./');\n\nvar tests = [\n  {\n    name: \"basic\",\n    fn: testBasic,\n  },\n  {\n    name: \"max\",\n    fn: testWithMax,\n  },\n  {\n    name: \"callback twice\",\n    fn: testCallbackTwice,\n  },\n  {\n    name: \"calling wait twice\",\n    fn: testCallingWaitTwice,\n  },\n  {\n    name: \"hold()\",\n    fn: testHoldFn,\n  },\n];\nvar testCount = tests.length;\n\ndoOneTest();\n\nfunction doOneTest() {\n  var test = tests.shift();\n  if (!test) {\n    console.log(testCount + \" tests passed.\");\n    return;\n  }\n  process.stdout.write(test.name + \"...\");\n  test.fn(function() {\n    process.stdout.write(\"OK\\n\");\n    doOneTest();\n  });\n}\n\nfunction testBasic(cb) {\n  var pend = new Pend();\n  var results = [];\n  pend.go(function(cb) {\n    results.push(1);\n    setTimeout(function() {\n      results.push(3);\n      cb();\n    }, 500);\n  });\n  pend.go(function(cb) {\n    results.push(2);\n    setTimeout(function() {\n      results.push(4);\n      cb();\n    }, 1000);\n  });\n  pend.wait(function(err) {\n    assert.deepEqual(results, [1,2,3,4]);\n    cb();\n  });\n  assert.deepEqual(results, [1, 2]);\n}\n\nfunction testWithMax(cb) {\n  var pend = new Pend();\n  var results = [];\n  pend.max = 2;\n  pend.go(function(cb) {\n    results.push('a');\n    setTimeout(function() {\n      results.push(1);\n      cb();\n    }, 500);\n  });\n  pend.go(function(cb) {\n    results.push('b');\n    setTimeout(function() {\n      results.push(1);\n      cb();\n    }, 500);\n  });\n  pend.go(function(cb) {\n    results.push('c');\n    setTimeout(function() {\n      results.push(2);\n      cb();\n    }, 100);\n  });\n  pend.wait(function(err) {\n    assert.deepEqual(results, ['a', 'b', 1, 'c', 1, 2]);\n    cb();\n  });\n  assert.deepEqual(results, ['a', 'b']);\n}\n\nfunction testCallbackTwice(cb) {\n  var pend = new Pend();\n  pend.go(function(cb) {\n    setTimeout(cb, 100);\n  });\n  pend.go(function(cb) {\n    cb();\n    assert.throws(cb, /callback called twice/);\n  });\n  pend.wait(cb);\n}\n\nfunction testCallingWaitTwice(cb) {\n  var pend = new Pend();\n  pend.go(function(cb) {\n    setTimeout(cb, 100);\n  });\n  pend.wait(function() {\n    pend.go(function(cb) {\n      setTimeout(cb, 50);\n    });\n    pend.go(function(cb) {\n      setTimeout(cb, 10);\n    });\n    pend.go(function(cb) {\n      setTimeout(cb, 20);\n    });\n    pend.wait(cb);\n  });\n}\n\nfunction testHoldFn(cb) {\n  var pend = new Pend();\n  setTimeout(pend.hold(), 100);\n  pend.go(function(cb) {\n    cb();\n  });\n  pend.wait(cb);\n}\n"]}