{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _postcss = require('postcss');\n\nvar _postcss2 = _interopRequireDefault(_postcss);\n\nvar _postcssValueParser = require('postcss-value-parser');\n\nvar _postcssValueParser2 = _interopRequireDefault(_postcssValueParser);\n\nvar _svgo = require('svgo');\n\nvar _svgo2 = _interopRequireDefault(_svgo);\n\nvar _isSvg = require('is-svg');\n\nvar _isSvg2 = _interopRequireDefault(_isSvg);\n\nvar _url = require('./lib/url');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar dataURI = /data:image\\/svg\\+xml(;(charset=)?utf-8)?,/;\n\nfunction minifyPromise(svgo, decl, opts) {\n    var promises = [];\n\n    decl.value = (0, _postcssValueParser2.default)(decl.value).walk(function (node) {\n        if (node.type !== 'function' || node.value !== 'url' || !node.nodes.length) {\n            return;\n        }\n        var value = node.nodes[0].value;\n\n        var decodedUri = (0, _url.decode)(value);\n        var isUriEncoded = decodedUri !== value;\n        if (isUriEncoded) {\n            value = decodedUri;\n        }\n        if (opts.encode !== undefined) {\n            isUriEncoded = opts.encode;\n        }\n\n        if (!dataURI.test(value) || !(0, _isSvg2.default)(value)) {\n            return;\n        }\n        promises.push(new Promise(function (resolve, reject) {\n            svgo.optimize(value.replace(dataURI, ''), function (result) {\n                if (result.error) {\n                    return reject('Error parsing SVG: ' + result.error);\n                }\n                node.before = node.after = '';\n                var data = isUriEncoded ? (0, _url.encode)(result.data) : result.data;\n                node.nodes[0].value = 'data:image/svg+xml;charset=utf-8,' + data;\n                node.nodes[0].quote = isUriEncoded ? '\"' : '\\'';\n                node.nodes[0].type = 'string';\n                resolve();\n            });\n        }));\n\n        return false;\n    });\n\n    return Promise.all(promises).then(function () {\n        return decl.value = decl.value.toString();\n    });\n}\n\nexports.default = _postcss2.default.plugin('postcss-svgo', function () {\n    var opts = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n    var svgo = new _svgo2.default(opts);\n    return function (css) {\n        return new Promise(function (resolve, reject) {\n            var promises = [];\n            css.walkDecls(function (decl) {\n                if (dataURI.test(decl.value)) {\n                    promises.push(minifyPromise(svgo, decl, opts));\n                }\n            });\n            Promise.all(promises).then(resolve, reject);\n        });\n    };\n});\nmodule.exports = exports['default'];"]}