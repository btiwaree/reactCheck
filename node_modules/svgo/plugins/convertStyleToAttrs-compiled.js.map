{"version":3,"sources":["convertStyleToAttrs.js"],"names":[],"mappings":"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","file":"convertStyleToAttrs-compiled.js","sourcesContent":["/* jshint quotmark: false */\n'use strict';\n\nexports.type = 'perItem';\n\nexports.active = true;\n\nexports.description = 'converts style to attributes';\n\nvar EXTEND = require('whet.extend'),\n    stylingProps = require('./_collections').attrsGroups.presentation,\n    rEscape = '\\\\\\\\(?:[0-9a-f]{1,6}\\\\s?|\\\\r\\\\n|.)',                 // Like \\\" or \\2051. Code points consume one space.\n    rAttr = '\\\\s*(' + g('[^:;\\\\\\\\]', rEscape) + '*?)\\\\s*',          // attribute name like ‘fill’\n    rSingleQuotes = \"'(?:[^'\\\\n\\\\r\\\\\\\\]|\" + rEscape + \")*?(?:'|$)\", // string in single quotes: 'smth'\n    rQuotes = '\"(?:[^\"\\\\n\\\\r\\\\\\\\]|' + rEscape + ')*?(?:\"|$)',       // string in double quotes: \"smth\"\n    rQuotedString = new RegExp('^' + g(rSingleQuotes, rQuotes) + '$'),\n\n    // Parentheses, E.g.: url(data:image/png;base64,iVBO...).\n    // ':' and ';' inside of it should be threated as is. (Just like in strings.)\n    rParenthesis = '\\\\(' + g('[^\\'\"()\\\\\\\\]+', rEscape, rSingleQuotes, rQuotes) + '*?' + '\\\\)',\n\n    // The value. It can have strings and parentheses (see above). Fallbacks to anything in case of unexpected input.\n    rValue = '\\\\s*(' + g('[^\\'\"();\\\\\\\\]+?', rEscape, rSingleQuotes, rQuotes, rParenthesis, '[^;]*?') + '*?' + ')',\n\n    // End of declaration. Spaces outside of capturing groups help to do natural trimming.\n    rDeclEnd = '\\\\s*(?:;\\\\s*|$)',\n\n    // Final RegExp to parse CSS declarations.\n    regDeclarationBlock = new RegExp(rAttr + ':' + rValue + rDeclEnd, 'ig'),\n\n    // Comments expression. Honors escape sequences and strings.\n    regStripComments = new RegExp(g(rEscape, rSingleQuotes, rQuotes, '/\\\\*[^]*?\\\\*/'), 'ig');\n\n/**\n * Convert style in attributes. Cleanups comments and illegal declarations (without colon) as a side effect.\n *\n * @example\n * <g style=\"fill:#000; color: #fff;\">\n *             ⬇\n * <g fill=\"#000\" color=\"#fff\">\n *\n * @example\n * <g style=\"fill:#000; color: #fff; -webkit-blah: blah\">\n *             ⬇\n * <g fill=\"#000\" color=\"#fff\" style=\"-webkit-blah: blah\">\n *\n * @param {Object} item current iteration item\n * @return {Boolean} if false, item will be filtered out\n *\n * @author Kir Belevich\n */\nexports.fn = function(item) {\n    /* jshint boss: true */\n\n    if (item.elem && item.hasAttr('style')) {\n            // ['opacity: 1', 'color: #000']\n        var styleValue = item.attr('style').value,\n            styles = [],\n            attrs = {};\n\n        // Strip CSS comments preserving escape sequences and strings.\n        styleValue = styleValue.replace(regStripComments, function(match) {\n            return match[0] == '/' ? '' :\n                match[0] == '\\\\' && /[-g-z]/i.test(match[1]) ? match[1] : match;\n        });\n\n        regDeclarationBlock.lastIndex = 0;\n        for (var rule; rule = regDeclarationBlock.exec(styleValue);) {\n            styles.push([rule[1], rule[2]]);\n        }\n\n        if (styles.length) {\n\n            styles = styles.filter(function(style) {\n                if (style[0]) {\n                    var prop = style[0].toLowerCase(),\n                        val = style[1];\n\n                    if (rQuotedString.test(val)) {\n                        val = val.slice(1, -1);\n                    }\n\n                    if (stylingProps.indexOf(prop) > -1) {\n\n                        attrs[prop] = {\n                            name: prop,\n                            value: val,\n                            local: prop,\n                            prefix: ''\n                        };\n\n                        return false;\n                    }\n                }\n\n                return true;\n            });\n\n            EXTEND(item.attrs, attrs);\n\n            if (styles.length) {\n                item.attr('style').value = styles\n                    .map(function(declaration) { return declaration.join(':') })\n                    .join(';');\n            } else {\n                item.removeAttr('style');\n            }\n\n        }\n\n    }\n\n};\n\nfunction g() {\n    return '(?:' + Array.prototype.join.call(arguments, '|') + ')';\n}\n"]}