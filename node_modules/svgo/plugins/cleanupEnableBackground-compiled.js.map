{"version":3,"sources":["cleanupEnableBackground.js"],"names":[],"mappings":"AAAA;;AAEA,QAAQ,IAAR,GAAe,MAAf;;AAEA,QAAQ,MAAR,GAAiB,IAAjB;;AAEA,QAAQ,WAAR,GAAsB,6DAAtB;;;;;;;;;;;;;;;;;AAiBA,QAAQ,EAAR,GAAa,UAAS,IAAT,EAAe;;AAExB,QAAI,sBAAsB,mFAAtB;QACA,YAAY,KAAZ;QACA,QAAQ,CAAC,KAAD,EAAQ,MAAR,EAAgB,SAAhB,CAAR,CAJoB;;AAMxB,aAAS,qBAAT,CAA+B,IAA/B,EAAqC;AACjC,YACI,KAAK,MAAL,CAAY,KAAZ,KACA,KAAK,OAAL,CAAa,mBAAb,CADA,IAEA,KAAK,OAAL,CAAa,OAAb,CAFA,IAGA,KAAK,OAAL,CAAa,QAAb,CAHA,EAIF;;AAEE,gBAAI,QAAQ,KAAK,IAAL,CAAU,mBAAV,EAA+B,KAA/B,CAAqC,KAArC,CAA2C,mBAA3C,CAAR,CAFN;;AAIE,gBAAI,KAAJ,EAAW;AACP,oBACI,KAAK,IAAL,CAAU,OAAV,EAAmB,KAAnB,KAA6B,MAAM,CAAN,CAA7B,IACA,KAAK,IAAL,CAAU,QAAV,EAAoB,KAApB,KAA8B,MAAM,CAAN,CAA9B,EACF;AACE,wBAAI,KAAK,MAAL,CAAY,KAAZ,CAAJ,EAAwB;AACpB,6BAAK,UAAL,CAAgB,mBAAhB,EADoB;qBAAxB,MAEO;AACH,6BAAK,IAAL,CAAU,mBAAV,EAA+B,KAA/B,GAAuC,KAAvC,CADG;qBAFP;iBAJJ;aADJ;SATJ;KADJ;;AA0BA,aAAS,cAAT,CAAwB,IAAxB,EAA8B;AAC1B,YAAI,KAAK,MAAL,CAAY,QAAZ,CAAJ,EAA2B;AACvB,wBAAY,IAAZ,CADuB;SAA3B;KADJ;;AAMA,aAAS,OAAT,CAAiB,KAAjB,EAAwB,EAAxB,EAA4B;AACxB,cAAM,OAAN,CAAc,OAAd,CAAsB,UAAS,IAAT,EAAe;AACjC,eAAG,IAAH,EADiC;;AAGjC,gBAAI,KAAK,OAAL,EAAc;AACd,wBAAQ,IAAR,EAAc,EAAd,EADc;aAAlB;SAHkB,CAAtB,CADwB;AAQxB,eAAO,KAAP,CARwB;KAA5B;;AAWA,QAAI,YAAY,QAAQ,IAAR,EAAc,UAAS,IAAT,EAAe;AACzC,8BAAsB,IAAtB,EADyC;AAEzC,YAAI,CAAC,SAAD,EAAY;AACZ,2BAAe,IAAf,EADY;SAAhB;KAF0B,CAA1B,CAjDoB;;AAwDxB,WAAO,YAAY,SAAZ,GAAwB,QAAQ,SAAR,EAAmB,UAAS,IAAT,EAAe;;AAEzD,aAAK,UAAL,CAAgB,mBAAhB,EAFyD;KAAf,CAA3C,CAxDiB;CAAf","file":"cleanupEnableBackground-compiled.js","sourcesContent":["'use strict';\n\nexports.type = 'full';\n\nexports.active = true;\n\nexports.description = 'remove or cleanup enable-background attribute when possible';\n\n/**\n * Remove or cleanup enable-background attr which coincides with a width/height box.\n *\n * @see http://www.w3.org/TR/SVG/filters.html#EnableBackgroundProperty\n *\n * @example\n * <svg width=\"100\" height=\"50\" enable-background=\"new 0 0 100 50\">\n *             â¬‡\n * <svg width=\"100\" height=\"50\">\n *\n * @param {Object} item current iteration item\n * @return {Boolean} if false, item will be filtered out\n *\n * @author Kir Belevich\n */\nexports.fn = function(data) {\n\n    var regEnableBackground = /^new\\s0\\s0\\s([\\-+]?\\d*\\.?\\d+([eE][\\-+]?\\d+)?)\\s([\\-+]?\\d*\\.?\\d+([eE][\\-+]?\\d+)?)$/,\n        hasFilter = false,\n        elems = ['svg', 'mask', 'pattern'];\n\n    function checkEnableBackground(item) {\n        if (\n            item.isElem(elems) &&\n            item.hasAttr('enable-background') &&\n            item.hasAttr('width') &&\n            item.hasAttr('height')\n        ) {\n\n            var match = item.attr('enable-background').value.match(regEnableBackground);\n\n            if (match) {\n                if (\n                    item.attr('width').value === match[1] &&\n                    item.attr('height').value === match[3]\n                ) {\n                    if (item.isElem('svg')) {\n                        item.removeAttr('enable-background');\n                    } else {\n                        item.attr('enable-background').value = 'new';\n                    }\n                }\n            }\n\n        }\n    }\n\n    function checkForFilter(item) {\n        if (item.isElem('filter')) {\n            hasFilter = true;\n        }\n    }\n\n    function monkeys(items, fn) {\n        items.content.forEach(function(item) {\n            fn(item);\n\n            if (item.content) {\n                monkeys(item, fn);\n            }\n        });\n        return items;\n    }\n\n    var firstStep = monkeys(data, function(item) {\n        checkEnableBackground(item);\n        if (!hasFilter) {\n            checkForFilter(item);\n        }\n    });\n\n    return hasFilter ? firstStep : monkeys(firstStep, function(item) {\n            //we don't need 'enable-background' if we have no filters\n            item.removeAttr('enable-background');\n        });\n};\n"]}