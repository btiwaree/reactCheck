{"version":3,"sources":["mergePaths.js"],"names":[],"mappings":"AAAA;;AAEA,QAAQ,IAAR,GAAe,SAAf;;AAEA,QAAQ,MAAR,GAAiB,IAAjB;;AAEA,QAAQ,WAAR,GAAsB,0CAAtB;;AAEA,QAAQ,MAAR,GAAiB;AACb,sBAAkB,IAAlB;AACA,iBAAa,IAAb;AACA,wBAAoB,IAApB;CAHJ;;AAMA,IAAI,UAAU,QAAQ,YAAR,EAAsB,OAAtB;IACV,UAAU,QAAQ,YAAR,EAAsB,OAAtB;IACV,aAAa,QAAQ,YAAR,EAAsB,UAAtB;;;;;;;;;;AAUjB,QAAQ,EAAR,GAAa,UAAS,IAAT,EAAe,MAAf,EAAuB;;AAEhC,QAAI,CAAC,KAAK,MAAL,EAAD,IAAkB,KAAK,OAAL,EAAlB,EAAkC,OAAtC;;AAEA,QAAI,kBAAkB,IAAlB;QACA,sBAAsB,IAAtB,CAL4B;;AAOhC,SAAK,OAAL,GAAe,KAAK,OAAL,CAAa,MAAb,CAAoB,UAAS,WAAT,EAAsB;;AAErD,YAAI,mBACA,gBAAgB,MAAhB,CAAuB,MAAvB,CADA,IAEA,gBAAgB,OAAhB,EAFA,IAGA,gBAAgB,OAAhB,CAAwB,GAAxB,CAHA,IAIA,YAAY,MAAZ,CAAmB,MAAnB,CAJA,IAKA,YAAY,OAAZ,EALA,IAMA,YAAY,OAAZ,CAAoB,GAApB,CANA,EAOF;;AAEE,gBAAI,CAAC,mBAAD,EAAsB;AACtB,sCAAsB,OAAO,IAAP,CAAY,gBAAgB,KAAhB,CAAlC,CADsB;aAA1B;;AAIA,gBAAI,mBAAmB,OAAO,IAAP,CAAY,YAAY,KAAZ,CAA/B;gBACA,YAAY,oBAAoB,MAApB,IAA8B,iBAAiB,MAAjB,IACtC,iBAAiB,KAAjB,CAAuB,UAAS,GAAT,EAAc;AACjC,uBAAO,OAAO,GAAP,IACH,gBAAgB,OAAhB,CAAwB,GAAxB,KACA,gBAAgB,IAAhB,CAAqB,GAArB,EAA0B,KAA1B,IAAmC,YAAY,IAAZ,CAAiB,GAAjB,EAAsB,KAAtB,CAHN;aAAd,CADf;gBAMZ,aAAa,QAAQ,eAAR,CAAb;gBACA,YAAY,QAAQ,WAAR,CAAZ,CAdN;;AAgBE,gBAAI,aAAa,CAAC,WAAW,UAAX,EAAuB,SAAvB,CAAD,EAAoC;AACjD,wBAAQ,eAAR,EAAyB,WAAW,MAAX,CAAkB,SAAlB,CAAzB,EAAuD,MAAvD,EADiD;AAEjD,uBAAO,KAAP,CAFiD;aAArD;SAvBJ;;AA6BA,0BAAkB,WAAlB,CA/BqD;AAgCrD,8BAAsB,IAAtB,CAhCqD;AAiCrD,eAAO,IAAP,CAjCqD;KAAtB,CAAnC,CAPgC;CAAvB","file":"mergePaths-compiled.js","sourcesContent":["'use strict';\n\nexports.type = 'perItem';\n\nexports.active = true;\n\nexports.description = 'merges multiple paths in one if possible';\n\nexports.params = {\n    collapseRepeated: true,\n    leadingZero: true,\n    negativeExtraSpace: true\n};\n\nvar path2js = require('./_path.js').path2js,\n    js2path = require('./_path.js').js2path,\n    intersects = require('./_path.js').intersects;\n\n/**\n * Merge multiple Paths into one.\n *\n * @param {Object} item current iteration item\n * @return {Boolean} if false, item will be filtered out\n *\n * @author Kir Belevich, Lev Solntsev\n */\nexports.fn = function(item, params) {\n\n    if (!item.isElem() || item.isEmpty()) return;\n\n    var prevContentItem = null,\n        prevContentItemKeys = null;\n\n    item.content = item.content.filter(function(contentItem) {\n\n        if (prevContentItem &&\n            prevContentItem.isElem('path') &&\n            prevContentItem.isEmpty() &&\n            prevContentItem.hasAttr('d') &&\n            contentItem.isElem('path') &&\n            contentItem.isEmpty() &&\n            contentItem.hasAttr('d')\n        ) {\n\n            if (!prevContentItemKeys) {\n                prevContentItemKeys = Object.keys(prevContentItem.attrs);\n            }\n\n            var contentItemAttrs = Object.keys(contentItem.attrs),\n                equalData = prevContentItemKeys.length == contentItemAttrs.length &&\n                    contentItemAttrs.every(function(key) {\n                        return key == 'd' ||\n                            prevContentItem.hasAttr(key) &&\n                            prevContentItem.attr(key).value == contentItem.attr(key).value;\n                    }),\n                prevPathJS = path2js(prevContentItem),\n                curPathJS = path2js(contentItem);\n\n            if (equalData && !intersects(prevPathJS, curPathJS)) {\n                js2path(prevContentItem, prevPathJS.concat(curPathJS), params);\n                return false;\n            }\n        }\n\n        prevContentItem = contentItem;\n        prevContentItemKeys = null;\n        return true;\n\n    });\n\n};\n"]}