{"version":3,"sources":["collapseGroups.js"],"names":[],"mappings":"AAAA;;AAEA,QAAQ,IAAR,GAAe,gBAAf;;AAEA,QAAQ,MAAR,GAAiB,IAAjB;;AAEA,QAAQ,WAAR,GAAsB,0BAAtB;;AAEA,IAAI,iBAAiB,QAAQ,gBAAR,EAA0B,WAA1B,CAAsC,SAAtC;;;;;;;;;;;;;;;;;;;;;;;;;AAyBrB,QAAQ,EAAR,GAAa,UAAS,IAAT,EAAe;;;AAGxB,QAAI,KAAK,MAAL,MAAiB,CAAC,KAAK,MAAL,CAAY,QAAZ,CAAD,IAA0B,CAAC,KAAK,OAAL,EAAD,EAAiB;;AAE5D,aAAK,OAAL,CAAa,OAAb,CAAqB,UAAS,CAAT,EAAY,CAAZ,EAAe;;;AAGhC,gBAAI,EAAE,MAAF,CAAS,GAAT,KAAiB,CAAC,EAAE,OAAF,EAAD,EAAc;;;AAG/B,oBAAI,EAAE,OAAF,MAAe,EAAE,OAAF,CAAU,MAAV,KAAqB,CAArB,EAAwB;AACvC,wBAAI,QAAQ,EAAE,OAAF,CAAU,CAAV,CAAR,CADmC;;AAGvC,wBAAI,MAAM,MAAN,MAAkB,CAAC,MAAM,OAAN,CAAc,IAAd,CAAD,KAClB,CAAC,EAAE,OAAF,CAAU,WAAV,CAAD,IACA,MAAM,MAAN,CAAa,GAAb,KAAqB,CAAC,EAAE,OAAF,CAAU,WAAV,CAAD,IAA2B,CAAC,MAAM,OAAN,CAAc,WAAd,CAAD,CAFhD,EAGD;AACC,0BAAE,QAAF,CAAW,UAAS,IAAT,EAAe;AACtB,gCAAI,CAAC,MAAM,OAAN,CAAc,KAAK,IAAL,CAAf,EAA2B;AAC3B,sCAAM,OAAN,CAAc,IAAd,EAD2B;6BAA/B,MAEO,IAAI,KAAK,IAAL,IAAa,WAAb,IAA4B,KAAK,IAAL,IAAa,OAAb,EAAsB;AACzD,sCAAM,IAAN,CAAW,KAAK,IAAL,CAAX,CAAsB,KAAtB,GAA8B,KAAK,KAAL,GAAa,GAAb,GAAmB,MAAM,IAAN,CAAW,KAAK,IAAL,CAAX,CAAsB,KAAtB,CADQ;6BAAtD;AAGP,8BAAE,UAAF,CAAa,KAAK,IAAL,CAAb,CANsB;yBAAf,CAAX,CADD;qBAHH;iBAHJ;;;AAH+B,oBAsB3B,CAAC,EAAE,OAAF,EAAD,IAAgB,CAAC,EAAE,OAAF,CAAU,IAAV,CAAe,UAAS,IAAT,EAAe;AAAE,2BAAO,KAAK,MAAL,CAAY,cAAZ,CAAP,CAAF;iBAAf,CAAhB,EAAwE;AACxF,yBAAK,aAAL,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,EAAE,OAAF,CAAzB,CADwF;iBAA5F;aAtBJ;SAHiB,CAArB,CAF4D;KAAhE;CAHS","file":"collapseGroups-compiled.js","sourcesContent":["'use strict';\n\nexports.type = 'perItemReverse';\n\nexports.active = true;\n\nexports.description = 'collapses useless groups';\n\nvar animationElems = require('./_collections').elemsGroups.animation;\n\n/*\n * Collapse useless groups.\n *\n * @example\n * <g>\n *     <g attr1=\"val1\">\n *         <path d=\"...\"/>\n *     </g>\n * </g>\n *         ⬇\n * <g>\n *     <g>\n *         <path attr1=\"val1\" d=\"...\"/>\n *     </g>\n * </g>\n *         ⬇\n * <path attr1=\"val1\" d=\"...\"/>\n *\n * @param {Object} item current iteration item\n * @return {Boolean} if false, item will be filtered out\n *\n * @author Kir Belevich\n */\nexports.fn = function(item) {\n\n    // non-empty elements\n    if (item.isElem() && !item.isElem('switch') && !item.isEmpty()) {\n\n        item.content.forEach(function(g, i) {\n\n            // non-empty groups\n            if (g.isElem('g') && !g.isEmpty()) {\n\n                // move group attibutes to the single content element\n                if (g.hasAttr() && g.content.length === 1) {\n                    var inner = g.content[0];\n\n                    if (inner.isElem() && !inner.hasAttr('id') && (\n                        !g.hasAttr('clip-path') ||\n                        inner.isElem('g') && !g.hasAttr('transform') && !inner.hasAttr('transform')\n                    )) {\n                        g.eachAttr(function(attr) {\n                            if (!inner.hasAttr(attr.name)) {\n                                inner.addAttr(attr);\n                            } else if (attr.name == 'transform' || attr.name == 'class') {\n                                inner.attr(attr.name).value = attr.value + ' ' + inner.attr(attr.name).value;\n                            }\n                            g.removeAttr(attr.name);\n                        });\n                    }\n                }\n\n                // collapse groups without attributes\n                if (!g.hasAttr() && !g.content.some(function(item) { return item.isElem(animationElems) })) {\n                    item.spliceContent(i, 1, g.content);\n                }\n            }\n\n        });\n\n    }\n\n};\n"]}