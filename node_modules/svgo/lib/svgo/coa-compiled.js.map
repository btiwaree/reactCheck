{"version":3,"sources":["coa.js"],"names":[],"mappings":";AACA;;AAEA,QAAQ,QAAR;;AAEA,IAAI,KAAK,QAAQ,IAAR,CAAL;IACA,OAAO,QAAQ,MAAR,CAAP;IACA,OAAO,QAAQ,YAAR,CAAP;IACA,OAAO,QAAQ,SAAR,CAAP;IACA,MAAM,QAAQ,oBAAR,CAAN;IACA,SAAS,QAAQ,QAAR,CAAT;IACA,mBAAmB,QAAQ,YAAR,EAAsB,gBAAtB;IACnB,mBAAmB,QAAQ,YAAR,EAAsB,gBAAtB;IACnB,aAAa,QAAb;;;;;;;AAOJ,OAAO,OAAP,GAAiB,QAAQ,KAAR,EAAe,GAAf,GACZ,OADY,GAEZ,IAFY,CAEP,IAAI,IAAJ,CAFO,CAGZ,KAHY,CAGN,IAAI,WAAJ,CAHM,CAIZ,GAJY,GAKR,IALQ,CAKH,SALG,EAKQ,KALR,CAKc,SALd,EAMR,KANQ,CAMF,GANE,EAMG,IANH,CAMQ,SANR,EAOR,IAPQ,GAQR,IARQ,GASR,GATQ,CASJ,YAAW;;AAEZ,YAAQ,MAAR,CAAe,KAAf,CAAqB,IAAI,OAAJ,GAAc,IAAd,CAArB;;AAFY,WAIL,EAAP,CAJY;CAAX,CATI,CAeR,GAfQ,GAgBZ,GAhBY,GAiBR,IAjBQ,CAiBH,OAjBG,EAiBM,KAjBN,CAiBY,2BAjBZ,EAkBR,KAlBQ,CAkBF,GAlBE,EAkBG,IAlBH,CAkBQ,OAlBR,EAmBR,GAnBQ,CAmBJ,UAAS,GAAT,EAAc;AACf,WAAO,OAAO,KAAK,MAAL,CAAY,qCAAZ,CAAP,CADQ;CAAd,CAnBI,CAsBR,GAtBQ,GAuBZ,GAvBY,GAwBR,IAxBQ,CAwBH,QAxBG,EAwBO,KAxBP,CAwBa,uBAxBb,EAyBR,KAzBQ,CAyBF,GAzBE,EAyBG,IAzBH,CAyBQ,QAzBR,EA0BR,GA1BQ,GA2BZ,GA3BY,GA4BR,IA5BQ,CA4BH,QA5BG,EA4BO,KA5BP,CA4Ba,oDA5Bb,EA6BR,KA7BQ,CA6BF,GA7BE,EA6BG,IA7BH,CA6BQ,QA7BR,EA8BR,GA9BQ,CA8BJ,UAAS,GAAT,EAAc;AACf,WAAO,OAAO,KAAK,MAAL,CAAY,sCAAZ,CAAP,CADQ;CAAd,CA9BI,CAiCR,GAjCQ,GAkCZ,GAlCY,GAmCR,IAnCQ,CAmCH,QAnCG,EAmCO,KAnCP,CAmCa,0EAnCb,EAoCR,KApCQ,CAoCF,GApCE,EAoCG,IApCH,CAoCQ,QApCR,EAqCR,GArCQ,CAqCJ,UAAS,GAAT,EAAc;AACf,WAAO,OAAO,KAAK,MAAL,CAAY,sCAAZ,CAAP,CADQ;CAAd,CArCI,CAwCR,GAxCQ,GAyCZ,GAzCY,GA0CR,IA1CQ,CA0CH,WA1CG,EA0CU,KA1CV,CA0CgB,uEA1ChB,EA2CR,KA3CQ,CA2CF,GA3CE,EA2CG,IA3CH,CA2CQ,WA3CR,EA4CR,GA5CQ,CA4CJ,UAAS,GAAT,EAAc;AACf,WAAO,CAAC,MAAM,GAAN,CAAD,GAAc,GAAd,GAAoB,KAAK,MAAL,CAAY,gDAAZ,CAApB,CADQ;CAAd,CA5CI,CA+CR,GA/CQ,GAgDZ,GAhDY,GAiDR,IAjDQ,CAiDH,QAjDG,EAiDO,KAjDP,CAiDa,0CAjDb,EAkDR,IAlDQ,CAkDH,QAlDG,EAmDR,GAnDQ,CAmDJ,UAAS,GAAT,EAAc;AACf,WAAO,OAAO,KAAK,MAAL,CAAY,sCAAZ,CAAP,CADQ;CAAd,CAnDI,CAsDR,GAtDQ,GAuDZ,GAvDY,GAwDR,IAxDQ,CAwDH,SAxDG,EAwDQ,KAxDR,CAwDc,wBAxDd,EAyDR,IAzDQ,CAyDH,SAzDG,EA0DR,GA1DQ,GA2DR,GA3DQ,CA2DJ,UAAS,GAAT,EAAc;AACf,WAAO,OAAO,KAAK,MAAL,CAAY,uCAAZ,CAAP,CADQ;CAAd,CA3DI,CA8DR,GA9DQ,GA+DZ,GA/DY,GAgER,IAhEQ,CAgEH,QAhEG,EAgEO,KAhEP,CAgEa,uBAhEb,EAiER,IAjEQ,CAiEH,QAjEG,EAkER,GAlEQ,GAmER,GAnEQ,CAmEJ,UAAS,GAAT,EAAc;AACf,WAAO,OAAO,KAAK,MAAL,CAAY,sCAAZ,CAAP,CADQ;CAAd,CAnEI,CAsER,GAtEQ,GAuEZ,GAvEY,GAwER,IAxEQ,CAwEH,SAxEG,EAwEQ,KAxER,CAwEc,8DAxEd,EAyER,IAzEQ,CAyEH,SAzEG,EA0ER,GA1EQ,CA0EJ,UAAS,GAAT,EAAc;AACf,WAAO,OAAO,KAAK,MAAL,CAAY,sFAAZ,CAAP,CADQ;CAAd,CA1EI,CA6ER,GA7EQ,GA8EZ,GA9EY,GA+ER,IA/EQ,CA+EH,WA/EG,EA+EU,KA/EV,CA+EgB,kBA/EhB,EAgFR,IAhFQ,CAgFH,WAhFG,EAiFR,IAjFQ,GAkFR,GAlFQ,GAmFZ,GAnFY,GAoFR,IApFQ,CAoFH,QApFG,EAoFO,KApFP,CAoFa,yBApFb,EAqFR,IArFQ,CAqFH,QArFG,EAsFR,IAtFQ,GAuFR,GAvFQ,GAwFZ,GAxFY,GAyFR,IAzFQ,CAyFH,QAzFG,EAyFO,KAzFP,CAyFa,yCAzFb,EA0FR,IA1FQ,CA0FH,QA1FG,EA2FR,GA3FQ,CA2FJ,UAAS,GAAT,EAAc;AACf,WAAO,CAAC,MAAM,GAAN,CAAD,GAAc,GAAd,GAAoB,KAAK,MAAL,CAAY,6CAAZ,CAApB,CADQ;CAAd,CA3FI,CA8FR,GA9FQ,GA+FZ,GA/FY,GAgGR,IAhGQ,CAgGH,OAhGG,EAgGM,KAhGN,CAgGY,yDAhGZ,EAiGR,KAjGQ,CAiGF,GAjGE,EAiGG,IAjGH,CAiGQ,OAjGR,EAkGR,IAlGQ,GAmGR,GAnGQ,GAoGZ,GApGY,GAqGR,IArGQ,CAqGH,cArGG,EAqGa,KArGb,CAqGmB,iCArGnB,EAsGR,IAtGQ,CAsGH,cAtGG,EAuGR,IAvGQ,GAwGR,GAxGQ,GAyGZ,GAzGY,GA0GR,IA1GQ,CA0GH,OA1GG,EA0GM,KA1GN,CA0GY,kBA1GZ,EA2GR,GA3GQ,GA4GZ,GA5GY,GA6GR,IA7GQ,CA6GH,QA7GG,EA6GO,KA7GP,CA6Ga,mBA7Gb,EA8GR,GA9GQ,GA+GZ,GA/GY,CA+GR,UAAS,IAAT,EAAe,IAAf,EAAqB;;AAEtB,QAAI,QAAQ,QAAQ,KAAK,KAAL,GAAa,KAAK,KAAL,GAAa,KAAK,KAAL;QAC1C,SAAS,QAAQ,KAAK,MAAL,GAAc,KAAK,MAAL,GAAc,KAAK,MAAL;QAC7C,SAAS,EAAT;;;AAJkB,QAOlB,KAAK,cAAL,CAAJ,EAA0B;;AAEtB,+BAFsB;AAGtB,gBAAQ,IAAR,CAAa,CAAb,EAHsB;KAA1B;;;AAPsB,QAgBlB,CAAC,CAAC,KAAD,IAAU,UAAU,GAAV,CAAX,IACA,CAAC,KAAK,MAAL,IACD,CAAC,KAAK,KAAL,IACD,CAAC,KAAK,MAAL,IACD,QAAQ,KAAR,CAAc,KAAd,EACF,OAAO,KAAK,KAAL,EAAP,CANF;;;AAfsB,QAyBlB,KAAK,MAAL,EAAa;;;AAGb,YAAI,KAAK,MAAL,CAAY,MAAZ,CAAmB,CAAnB,MAA0B,GAA1B,EAA+B;AAC/B,gBAAI;AACA,yBAAS,KAAK,KAAL,CAAW,KAAK,MAAL,CAApB,CADA;aAAJ,CAEE,OAAO,CAAP,EAAU;AACR,wBAAQ,KAAR,CAAc,oCAAd,EADQ;AAER,wBAAQ,KAAR,CAAc,OAAO,CAAP,CAAd,EAFQ;AAGR,uBAHQ;aAAV;;;AAH6B,SAAnC,MAUO;AACH,oBAAI,aAAa,KAAK,OAAL,CAAa,KAAK,MAAL,CAA1B,CADD;AAEH,oBAAI;;AAEA,6BAAS,KAAK,KAAL,CAAW,GAAG,YAAH,CAAgB,UAAhB,EAA4B,MAA5B,CAAX,CAAT,CAFA;iBAAJ,CAGE,OAAO,GAAP,EAAY;AACV,wBAAI,IAAI,IAAJ,KAAa,QAAb,EAAuB;AACvB,gCAAQ,KAAR,CAAc,yCAAyC,KAAK,MAAL,GAAc,KAAvD,CAAd,CADuB;AAEvB,+BAFuB;qBAA3B,MAGO,IAAI,IAAI,IAAJ,KAAa,QAAb,EAAuB;AAC9B,gCAAQ,KAAR,CAAc,wBAAwB,KAAK,MAAL,GAAc,0BAAtC,CAAd,CAD8B;AAE9B,+BAF8B;qBAA3B;AAIP,6BAAS,KAAK,QAAL,CAAc,GAAG,YAAH,CAAgB,UAAhB,EAA4B,MAA5B,CAAd,CAAT,CARU;;AAUV,wBAAI,CAAC,MAAD,IAAW,MAAM,OAAN,CAAc,MAAd,CAAX,EAAkC;AAClC,gCAAQ,KAAR,CAAc,kCAAkC,KAAK,MAAL,GAAc,KAAhD,CAAd,CADkC;AAElC,+BAFkC;qBAAtC;iBAVF;aAfN;KAHJ;;;AAzBsB,QA+DlB,KAAK,KAAL,EAAY;AACZ,eAAO,KAAP,GAAe,KAAK,KAAL,CADH;KAAhB;;;AA/DsB,QAoElB,KAAK,SAAL,EAAgB;AAChB,eAAO,cAAP,GAAwB,KAAK,GAAL,CAAS,CAAT,EAAY,SAAS,KAAK,SAAL,CAArB,CAAxB,CADgB;KAApB;;;AApEsB,QAyElB,KAAK,OAAL,EAAc;AACd,2BAAmB,KAAK,OAAL,EAAc,KAAjC,EAAwC,MAAxC,EADc;KAAlB;;;AAzEsB,QA8ElB,KAAK,MAAL,EAAa;AACb,2BAAmB,KAAK,MAAL,EAAa,IAAhC,EAAsC,MAAtC,EADa;KAAjB;;;AA9EsB,QAmFlB,KAAK,SAAL,EAAgB;;AAEhB,eAAO,SAAP,GAAmB,IAAnB,CAFgB;KAApB;;;AAnFsB,QA0FlB,KAAK,MAAL,EAAa;;AAEb,eAAO,MAAP,GAAgB,OAAO,MAAP,IAAiB,EAAjB,CAFH;AAGb,eAAO,MAAP,CAAc,MAAd,GAAuB,IAAvB,CAHa;AAIb,YAAI,KAAK,MAAL,EAAa;AACb,mBAAO,MAAP,CAAc,MAAd,GAAuB,SAAS,KAAK,MAAL,EAAa,EAAtB,CAAvB,CADa;SAAjB;KAJJ;;;AA1FsB,QAqGlB,KAAK,MAAL,EAAa;AACb,eAAO,MAAP,GAAgB,KAAK,MAAL,CADH;KAAjB;;;AArGsB,QA0GlB,KAAK,MAAL,EAAa;AACb,uBAAe,KAAK,MAAL,EAAa,MAA5B,EAAoC,MAApC,EADa;;AAGb,eAHa;KAAjB;;;AA1GsB,QAiHlB,KAAJ,EAAW;;;AAGP,YAAI,UAAU,GAAV,EAAe;;AAEf,gBAAI,OAAO,EAAP,CAFW;;AAIf,oBAAQ,KAAR,CAAc,KAAd,GAJe;;AAMf,oBAAQ,KAAR,CACK,EADL,CACQ,MADR,EACgB,UAAS,KAAT,EAAgB;AACxB,wBAAQ,KAAR,CADwB;aAAhB,CADhB,CAIK,IAJL,CAIU,KAJV,EAIiB,YAAW;AACpB,mCAAmB,IAAnB,EAAyB,MAAzB,EAAiC,KAAK,OAAL,EAAc,KAA/C,EAAsD,MAAtD,EADoB;aAAX,CAJjB,CAOK,MAPL;;;AANe,SAAnB,MAgBO;;AAEH,mBAAG,QAAH,CAAY,KAAZ,EAAmB,MAAnB,EAA2B,UAAS,GAAT,EAAc,IAAd,EAAoB;AAC3C,wBAAI,GAAJ,EAAS;AACL,4BAAI,IAAI,IAAJ,KAAa,QAAb,EACA,eAAe,KAAf,EAAsB,MAAtB,EAA8B,MAA9B,EADJ,KAEK,IAAI,IAAI,IAAJ,KAAa,QAAb,EACL,QAAQ,KAAR,CAAc,wCAAwC,KAAxC,GAAgD,KAAhD,CAAd,CADC,KAGD,QAAQ,KAAR,CAAc,GAAd,EAHC;AAIL,+BAPK;qBAAT;AASA,uCAAmB,IAAnB,EAAyB,MAAzB,EAAiC,KAAK,OAAL,EAAc,KAA/C,EAAsD,MAAtD,EAV2C;iBAApB,CAA3B,CAFG;aAhBP;;;AAHO,KAAX,MAqCO,IAAI,KAAK,MAAL,EAAa;;AAEpB,iBAAK,MAAL,GAAc,iBAAiB,KAAK,MAAL,CAA/B,CAFoB;;AAIpB,+BAAmB,KAAK,MAAL,EAAa,MAAhC,EAAwC,KAAK,OAAL,EAAc,KAAtD,EAA6D,MAA7D,EAJoB;SAAjB;CAtJN,CA/GT;;AA8QA,SAAS,kBAAT,CAA4B,MAA5B,EAAoC,MAApC,EAA4C,OAA5C,EAAqD,KAArD,EAA4D,MAA5D,EAAoE;;AAEhE,QAAI,YAAY,KAAK,GAAL,CAAS,MAAT,CAAZ;QACA,IADJ;QAEI,UAAU,OAAO,UAAP,CAAkB,MAAlB,EAA0B,MAA1B,CAAV;QACA,QAHJ;QAII,OAAO,IAAI,IAAJ,CAAS,MAAT,CAAP,CAN4D;;AAQhE,SAAK,QAAL,CAAc,MAAd,EAAsB,UAAS,MAAT,EAAiB;;AAEnC,YAAI,OAAO,KAAP,EAAc;AACd,oBAAQ,KAAR,CAAc,OAAO,KAAP,CAAd,CADc;AAEd,mBAFc;SAAlB;;AAKA,YAAI,OAAJ,EAAa;AACT,mBAAO,IAAP,GAAc,iBAAiB,OAAO,IAAP,EAAa,OAA9B,CAAd,CADS;SAAb;;AAIA,mBAAW,OAAO,UAAP,CAAkB,OAAO,IAAP,EAAa,MAA/B,CAAX,CAXmC;AAYnC,eAAO,KAAK,GAAL,KAAa,SAAb;;;AAZ4B,YAe/B,WAAW,GAAX,IAAkB,CAAC,CAAC,KAAD,IAAU,UAAU,GAAV,CAAX,IAA6B,CAAC,MAAD,EAAS;;AAExD,oBAAQ,MAAR,CAAe,KAAf,CAAqB,OAAO,IAAP,GAAc,IAAd,CAArB;;;AAFwD,SAA5D,MAKO;;;AAGH,oBAAI,CAAC,MAAD,IAAW,KAAX,EAAkB;AAClB,6BAAS,KAAT,CADkB;iBAAtB;;AAIA,oBAAI,CAAC,OAAO,KAAP,EAAc;AACf,4BAAQ,GAAR,CAAY,IAAZ,EADe;iBAAnB;;AAIA,qCAAqB,MAArB,EAA6B,OAAO,IAAP,EAAa,MAA1C,EAAkD,OAAlD,EAA2D,QAA3D,EAAqE,IAArE,EAXG;aALP;KAfkB,CAAtB,CARgE;CAApE;;AA+CA,SAAS,oBAAT,CAA8B,MAA9B,EAAsC,IAAtC,EAA4C,IAA5C,EAAkD,OAAlD,EAA2D,QAA3D,EAAqE,IAArE,EAA2E;;AAEvE,OAAG,SAAH,CAAa,IAAb,EAAmB,IAAnB,EAAyB,MAAzB,EAAiC,YAAW;AACxC,YAAI,OAAO,KAAP,EAAc;AACd,mBADc;SAAlB;;;AADwC,qBAMxC,CAAc,IAAd;;;AANwC,uBASxC,CAAgB,OAAhB,EAAyB,QAAzB,EATwC;KAAX,CAAjC,CAFuE;CAA3E;;AAiBA,SAAS,aAAT,CAAuB,IAAvB,EAA6B;AACzB,YAAQ,GAAR,CAAY,aAAa,IAAb,GAAoB,MAApB,CAAZ,CADyB;CAA7B;;AAKA,SAAS,eAAT,CAAyB,OAAzB,EAAkC,QAAlC,EAA4C;;AAExC,QAAI,iBAAiB,MAAM,WAAW,GAAX,GAAiB,OAAjB,CAFa;;AAIxC,YAAQ,GAAR,CACI,IAAC,CAAK,KAAL,CAAW,OAAC,GAAU,IAAV,GAAkB,IAAnB,CAAX,GAAsC,IAAtC,GAA8C,MAA/C,IACC,iBAAiB,CAAjB,GAAqB,KAArB,GAA6B,KAA7B,CADD,GAEA,OAAO,KAAK,GAAL,CAAU,KAAK,KAAL,CAAW,iBAAiB,EAAjB,CAAX,GAAkC,EAAlC,CAAV,GAAmD,GAAnD,CAAP,CAA+D,KAA/D,GAAuE,KAFvE,GAGC,KAAK,KAAL,CAAW,QAAC,GAAW,IAAX,GAAmB,IAApB,CAAX,GAAuC,IAAvC,GAA+C,QAHhD,CADJ,CAJwC;CAA5C;;;;;;;;;;AAqBA,SAAS,kBAAT,CAA4B,KAA5B,EAAmC,KAAnC,EAA0C,MAA1C,EAAkD;;;AAG9C,QAAI,OAAO,OAAP,EAAgB;;AAEhB,cAAM,OAAN,CAAc,UAAS,IAAT,EAAe;;AAEzB,gBAAI,OAAJ,EACI,GADJ,CAFyB;;AAKzB,mBAAO,OAAP,CAAe,OAAf,CAAuB,UAAS,MAAT,EAAiB;;;AAGpC,oBAAI,OAAO,MAAP,KAAkB,QAAlB,EAA4B;AAC5B,0BAAM,OAAO,IAAP,CAAY,MAAZ,EAAoB,CAApB,CAAN,CAD4B;iBAAhC,MAEO;AACH,0BAAM,MAAN,CADG;iBAFP;;;AAHoC,oBAUhC,QAAQ,IAAR,EAAc;;AAEd,wBAAI,OAAO,OAAO,GAAP,CAAP,KAAuB,QAAvB,IAAmC,CAAC,KAAD,EAAQ;AAC3C,+BAAO,GAAP,IAAc,KAAd,CAD2C;qBAA/C;;;AAFc,2BAOd,GAAU,IAAV,CAPc;iBAAlB;aAVmB,CAAvB;;;AALyB,gBA4BrB,CAAC,OAAD,IAAY,CAAC,OAAO,IAAP,EAAa;;AAE1B,oBAAI,MAAM,EAAN,CAFsB;;AAI1B,oBAAI,IAAJ,IAAY,KAAZ;;;AAJ0B,sBAO1B,CAAO,OAAP,CAAe,IAAf,CAAoB,GAApB,EAP0B;;AAS1B,0BAAU,IAAV,CAT0B;aAA9B;SA5BU,CAAd;;;AAFgB,KAApB,MA8CO;;AAEH,mBAAO,OAAP,GAAiB,EAAjB,CAFG;;AAIH,kBAAM,OAAN,CAAc,UAAS,IAAT,EAAe;AACzB,oBAAI,MAAM,EAAN,CADqB;;AAGzB,oBAAI,IAAJ,IAAY,KAAZ,CAHyB;;AAKzB,uBAAO,OAAP,CAAe,IAAf,CAAoB,GAApB,EALyB;aAAf,CAAd,CAJG;SA9CP;;AA4DA,WAAO,MAAP,CA/D8C;CAAlD;;AAmEA,SAAS,cAAT,CAAwB,GAAxB,EAA6B,MAA7B,EAAqC,MAArC,EAA6C;;AAEzC,QAAI,OAAO,IAAI,IAAJ,CAAS,MAAT,CAAP,CAFqC;;AAIzC,QAAI,CAAC,OAAO,KAAP,EAAc;AACf,gBAAQ,GAAR,CAAY,4BAA4B,GAA5B,GAAkC,OAAlC,CAAZ,CADe;KAAnB;;;AAJyC,QASrC,OAAO,KAAK,OAAL,CAAa,GAAb,CAAP;;;AATqC,MAYzC,CAAG,OAAH,CAAW,IAAX,EAAiB,UAAS,GAAT,EAAc,KAAd,EAAqB;;AAElC,YAAI,GAAJ,EAAS;AACL,oBAAQ,KAAR,CAAc,GAAd,EADK;AAEL,mBAFK;SAAT;;AAKA,YAAI,CAAC,MAAM,MAAN,EAAc;AACf,oBAAQ,GAAR,CAAY,iBAAiB,GAAjB,GAAuB,cAAvB,CAAZ,CADe;AAEf,mBAFe;SAAnB;;AAKA,YAAI,IAAI,CAAJ;YACA,QAAQ,KAAR,CAb8B;;AAelC,iBAAS,YAAT,CAAsB,IAAtB,EAA4B;;;AAGxB,gBAAI,WAAW,KAAK,OAAL,CAAa,IAAb,EAAmB,IAAnB,CAAX,CAHoB;AAIxB,gBAAI,cAAc,SAAS,KAAK,OAAL,CAAa,MAAb,EAAqB,IAArB,CAAT,GAAsC,QAAtC;;;AAJM,gBAOpB,WAAW,IAAX,CAAgB,QAAhB,CAAJ,EAA+B;;AAE3B,wBAAQ,IAAR,CAF2B;AAG3B,mBAAG,QAAH,CAAY,QAAZ,EAAsB,MAAtB,EAA8B,UAAS,GAAT,EAAc,IAAd,EAAoB;;AAE9C,wBAAI,GAAJ,EAAS;AACL,gCAAQ,KAAR,CAAc,GAAd,EADK;AAEL,+BAFK;qBAAT;;AAKA,wBAAI,YAAY,KAAK,GAAL,EAAZ;wBACA,IADJ;wBAEI,UAAU,OAAO,UAAP,CAAkB,IAAlB,EAAwB,MAAxB,CAAV;wBACA,QAHJ,CAP8C;;AAY9C,yBAAK,QAAL,CAAc,IAAd,EAAoB,UAAS,MAAT,EAAiB;;AAEjC,4BAAI,OAAO,KAAP,EAAc;AACd,oCAAQ,KAAR,CAAc,OAAO,KAAP,CAAd,CADc;AAEd,mCAFc;yBAAlB;;AAKA,mCAAW,OAAO,UAAP,CAAkB,OAAO,IAAP,EAAa,MAA/B,CAAX,CAPiC;AAQjC,+BAAO,KAAK,GAAL,KAAa,SAAb,CAR0B;;AAUjC,sCAViC;;AAYjC,iCAAS,WAAT,GAAuB;AACnB,+BAAG,SAAH,CAAa,WAAb,EAA0B,OAAO,IAAP,EAAa,MAAvC,EAA+C,MAA/C,EADmB;yBAAvB;;AAIA,iCAAS,MAAT,CAAgB,GAAhB,EAAqB;;AAEjB,gCAAI,GAAJ,EAAS;AACL,oCAAI,IAAI,IAAJ,KAAa,QAAb,EAAuB;AACvB,2CAAO,MAAP,EAAe,WAAf,EADuB;AAEvB,2CAFuB;iCAA3B,MAGO,IAAI,IAAI,IAAJ,KAAa,SAAb,EAAwB;AAC/B,4CAAQ,KAAR,CAAc,qBAAqB,MAArB,GAA8B,wBAA9B,CAAd,CAD+B;AAE/B,2CAF+B;iCAA5B;AAIP,wCAAQ,KAAR,CAAc,GAAd,EARK;AASL,uCATK;6BAAT;;AAYA,gCAAI,CAAC,OAAO,KAAP,EAAc;AACf,wCAAQ,GAAR,CAAY,OAAO,GAAP,CAAZ;;;AADe,6CAIf,CAAc,IAAd;;;AAJe,+CAOf,CAAgB,OAAhB,EAAyB,QAAzB,EAPe;6BAAnB;;;AAdiB,gCAyBb,EAAE,CAAF,GAAM,MAAM,MAAN,EAAc;AACpB,6CAAa,MAAM,CAAN,CAAb,EADoB;6BAAxB;yBAzBJ;qBAhBgB,CAApB,CAZ8C;iBAApB,CAA9B,CAH2B;;;AAA/B,iBAoEK,IAAI,EAAE,CAAF,GAAM,MAAM,MAAN,EAAc;AACzB,iCAAa,MAAM,CAAN,CAAb,EADyB;iBAAxB,MAEE,IAAI,CAAC,KAAD,EAAQ;AACf,4BAAQ,GAAR,CAAY,+BAAZ,EADe;iBAAZ;SA7EX;;AAoFA,qBAAa,MAAM,CAAN,CAAb,EAnGkC;KAArB,CAAjB,CAZyC;CAA7C;;AAsHA,IAAI,uBAAuB,YAAY;;AAEnC,QAAI,OAAO,IAAI,IAAJ,EAAP;;;AAEA,WAAO,MAAM,SAAN,CAAgB,MAAhB,CAAuB,KAAvB,CAA6B,EAA7B,EAAiC,KAAK,MAAL,CAAY,OAAZ,CAAjC,CAAsD,IAAtD,CAA2D,UAAS,CAAT,EAAY,CAAZ,EAAe;AAC7E,eAAO,EAAE,IAAF,GAAS,EAAE,IAAF,GAAS,CAAlB,GAAsB,CAAC,CAAD,CADgD;KAAf,CAAlE,CAJ+B;;AAQnC,YAAQ,GAAR,CAAY,8BAAZ,EARmC;;AAUnC,SAAK,OAAL,CAAa,UAAU,MAAV,EAAkB;AAC3B,gBAAQ,GAAR,CAAY,QAAQ,OAAO,IAAP,CAAY,KAAZ,GAAoB,KAA5B,GAAoC,OAAO,WAAP,CAAhD,CAD2B;KAAlB,CAAb;;;AAVmC,CAAZ","file":"coa-compiled.js","sourcesContent":["/* jshint quotmark: false */\n'use strict';\n\nrequire('colors');\n\nvar FS = require('fs'),\n    PATH = require('path'),\n    SVGO = require('../svgo.js'),\n    YAML = require('js-yaml'),\n    PKG = require('../../package.json'),\n    mkdirp = require('mkdirp'),\n    encodeSVGDatauri = require('./tools.js').encodeSVGDatauri,\n    decodeSVGDatauri = require('./tools.js').decodeSVGDatauri,\n    regSVGFile = /\\.svg$/;\n\n/**\n * Command-Option-Argument.\n *\n * @see https://github.com/veged/coa\n */\nmodule.exports = require('coa').Cmd()\n    .helpful()\n    .name(PKG.name)\n    .title(PKG.description)\n    .opt()\n        .name('version').title('Version')\n        .short('v').long('version')\n        .only()\n        .flag()\n        .act(function() {\n            // output the version to stdout instead of stderr if returned\n            process.stdout.write(PKG.version + '\\n');\n            // coa will run `.toString` on the returned value and send it to stderr\n            return '';\n        })\n        .end()\n    .opt()\n        .name('input').title('Input file, \"-\" for STDIN')\n        .short('i').long('input')\n        .val(function(val) {\n            return val || this.reject(\"Option '--input' must have a value.\");\n        })\n        .end()\n    .opt()\n        .name('string').title('Input SVG data string')\n        .short('s').long('string')\n        .end()\n    .opt()\n        .name('folder').title('Input folder, optimize and rewrite all *.svg files')\n        .short('f').long('folder')\n        .val(function(val) {\n            return val || this.reject(\"Option '--folder' must have a value.\");\n        })\n        .end()\n    .opt()\n        .name('output').title('Output file or folder (by default the same as the input), \"-\" for STDOUT')\n        .short('o').long('output')\n        .val(function(val) {\n            return val || this.reject(\"Option '--output' must have a value.\");\n        })\n        .end()\n    .opt()\n        .name('precision').title('Set number of digits in the fractional part, overrides plugins params')\n        .short('p').long('precision')\n        .val(function(val) {\n            return !isNaN(val) ? val : this.reject(\"Option '--precision' must be an integer number\");\n        })\n        .end()\n    .opt()\n        .name('config').title('Config file to extend or replace default')\n        .long('config')\n        .val(function(val) {\n            return val || this.reject(\"Option '--config' must have a value.\");\n        })\n        .end()\n    .opt()\n        .name('disable').title('Disable plugin by name')\n        .long('disable')\n        .arr()\n        .val(function(val) {\n            return val || this.reject(\"Option '--disable' must have a value.\");\n        })\n        .end()\n    .opt()\n        .name('enable').title('Enable plugin by name')\n        .long('enable')\n        .arr()\n        .val(function(val) {\n            return val || this.reject(\"Option '--enable' must have a value.\");\n        })\n        .end()\n    .opt()\n        .name('datauri').title('Output as Data URI string (base64, URI encoded or unencoded)')\n        .long('datauri')\n        .val(function(val) {\n            return val || this.reject(\"Option '--datauri' must have one of the following values: 'base64', 'enc' or 'unenc'\");\n        })\n        .end()\n    .opt()\n        .name('multipass').title('Enable multipass')\n        .long('multipass')\n        .flag()\n        .end()\n    .opt()\n        .name('pretty').title('Make SVG pretty printed')\n        .long('pretty')\n        .flag()\n        .end()\n    .opt()\n        .name('indent').title('Indent number when pretty printing SVGs')\n        .long('indent')\n        .val(function(val) {\n            return !isNaN(val) ? val : this.reject(\"Option '--indent' must be an integer number\");\n        })\n        .end()\n    .opt()\n        .name('quiet').title('Only output error messages, not regular status messages')\n        .short('q').long('quiet')\n        .flag()\n        .end()\n    .opt()\n        .name('show-plugins').title('Show available plugins and exit')\n        .long('show-plugins')\n        .flag()\n        .end()\n    .arg()\n        .name('input').title('Alias to --input')\n        .end()\n    .arg()\n        .name('output').title('Alias to --output')\n        .end()\n    .act(function(opts, args) {\n\n        var input = args && args.input ? args.input : opts.input,\n            output = args && args.output ? args.output : opts.output,\n            config = {};\n\n        // --show-plugins\n        if (opts['show-plugins']) {\n\n            showAvailablePlugins();\n            process.exit(0);\n\n        }\n\n        // w/o anything\n        if (\n            (!input || input === '-') &&\n            !opts.string &&\n            !opts.stdin &&\n            !opts.folder &&\n            process.stdin.isTTY\n        ) return this.usage();\n\n\n        // --config\n        if (opts.config) {\n\n            // string\n            if (opts.config.charAt(0) === '{') {\n                try {\n                    config = JSON.parse(opts.config);\n                } catch (e) {\n                    console.error(\"Error: Couldn't parse config JSON.\");\n                    console.error(String(e));\n                    return;\n                }\n\n            // external file\n            } else {\n                var configPath = PATH.resolve(opts.config);\n                try {\n                    // require() adds some weird output on YML files\n                    config = JSON.parse(FS.readFileSync(configPath, 'utf8'));\n                } catch (err) {\n                    if (err.code === 'ENOENT') {\n                        console.error('Error: couldn\\'t find config file \\'' + opts.config + '\\'.');\n                        return;\n                    } else if (err.code === 'EISDIR') {\n                        console.error('Error: directory \\'' + opts.config + '\\' is not a config file.');\n                        return;\n                    }\n                    config = YAML.safeLoad(FS.readFileSync(configPath, 'utf8'));\n\n                    if (!config || Array.isArray(config)) {\n                        console.error('Error: invalid config file \\'' + opts.config + '\\'.');\n                        return;\n                    }\n                }\n            }\n\n        }\n\n        // --quiet\n        if (opts.quiet) {\n            config.quiet = opts.quiet;\n        }\n\n        // --precision\n        if (opts.precision) {\n            config.floatPrecision = Math.max(0, parseInt(opts.precision));\n        }\n\n        // --disable\n        if (opts.disable) {\n            changePluginsState(opts.disable, false, config);\n        }\n\n        // --enable\n        if (opts.enable) {\n            changePluginsState(opts.enable, true, config);\n        }\n\n        // --multipass\n        if (opts.multipass) {\n\n            config.multipass = true;\n\n        }\n\n        // --pretty\n        if (opts.pretty) {\n\n            config.js2svg = config.js2svg || {};\n            config.js2svg.pretty = true;\n            if (opts.indent) {\n                config.js2svg.indent = parseInt(opts.indent, 10);\n            }\n\n        }\n\n        // --output\n        if (opts.output) {\n            config.output = opts.output;\n        }\n\n        // --folder\n        if (opts.folder) {\n            optimizeFolder(opts.folder, config, output);\n\n            return;\n        }\n\n        // --input\n        if (input) {\n\n            // STDIN\n            if (input === '-') {\n\n                var data = '';\n\n                process.stdin.pause();\n\n                process.stdin\n                    .on('data', function(chunk) {\n                        data += chunk;\n                    })\n                    .once('end', function() {\n                        optimizeFromString(data, config, opts.datauri, input, output);\n                    })\n                    .resume();\n\n            // file\n            } else {\n\n                FS.readFile(input, 'utf8', function(err, data) {\n                    if (err) {\n                        if (err.code === 'EISDIR')\n                            optimizeFolder(input, config, output);\n                        else if (err.code === 'ENOENT')\n                            console.error('Error: no such file or directory \\'' + input + '\\'.');\n                        else\n                            console.error(err);\n                        return;\n                    }\n                    optimizeFromString(data, config, opts.datauri, input, output);\n                });\n\n            }\n\n        // --string\n        } else if (opts.string) {\n\n            opts.string = decodeSVGDatauri(opts.string);\n\n            optimizeFromString(opts.string, config, opts.datauri, input, output);\n\n        }\n    });\n\nfunction optimizeFromString(svgstr, config, datauri, input, output) {\n\n    var startTime = Date.now(config),\n        time,\n        inBytes = Buffer.byteLength(svgstr, 'utf8'),\n        outBytes,\n        svgo = new SVGO(config);\n\n    svgo.optimize(svgstr, function(result) {\n\n        if (result.error) {\n            console.error(result.error);\n            return;\n        }\n\n        if (datauri) {\n            result.data = encodeSVGDatauri(result.data, datauri);\n        }\n\n        outBytes = Buffer.byteLength(result.data, 'utf8');\n        time = Date.now() - startTime;\n\n        // stdout\n        if (output === '-' || (!input || input === '-') && !output) {\n\n            process.stdout.write(result.data + '\\n');\n\n        // file\n        } else {\n\n            // overwrite input file if there is no output\n            if (!output && input) {\n                output = input;\n            }\n\n            if (!config.quiet) {\n                console.log('\\r');\n            }\n\n            saveFileAndPrintInfo(config, result.data, output, inBytes, outBytes, time);\n\n        }\n\n    });\n\n}\n\nfunction saveFileAndPrintInfo(config, data, path, inBytes, outBytes, time) {\n\n    FS.writeFile(path, data, 'utf8', function() {\n        if (config.quiet) {\n            return;\n        }\n\n        // print time info\n        printTimeInfo(time);\n\n        // print optimization profit info\n        printProfitInfo(inBytes, outBytes);\n\n    });\n\n}\n\nfunction printTimeInfo(time) {\n    console.log('Done in ' + time + ' ms!');\n\n}\n\nfunction printProfitInfo(inBytes, outBytes) {\n\n    var profitPercents = 100 - outBytes * 100 / inBytes;\n\n    console.log(\n        (Math.round((inBytes / 1024) * 1000) / 1000) + ' KiB' +\n        (profitPercents < 0 ? ' + ' : ' - ') +\n        String(Math.abs((Math.round(profitPercents * 10) / 10)) + '%').green + ' = ' +\n        (Math.round((outBytes / 1024) * 1000) / 1000) + ' KiB\\n'\n    );\n\n}\n\n/**\n * Change plugins state by names array.\n *\n * @param {Array} names plugins names\n * @param {Boolean} state active state\n * @param {Object} config original config\n * @return {Object} changed config\n */\nfunction changePluginsState(names, state, config) {\n\n    // extend config\n    if (config.plugins) {\n\n        names.forEach(function(name) {\n\n            var matched,\n                key;\n\n            config.plugins.forEach(function(plugin) {\n\n                // get plugin name\n                if (typeof plugin === 'object') {\n                    key = Object.keys(plugin)[0];\n                } else {\n                    key = plugin;\n                }\n\n                // if there is such a plugin name\n                if (key === name) {\n                    // don't replace plugin's params with true\n                    if (typeof plugin[key] !== 'object' || !state) {\n                        plugin[key] = state;\n                    }\n\n                    // mark it as matched\n                    matched = true;\n                }\n\n            });\n\n            // if not matched and current config is not full\n            if (!matched && !config.full) {\n\n                var obj = {};\n\n                obj[name] = state;\n\n                // push new plugin Object\n                config.plugins.push(obj);\n\n                matched = true;\n\n            }\n\n        });\n\n    // just push\n    } else {\n\n        config.plugins = [];\n\n        names.forEach(function(name) {\n            var obj = {};\n\n            obj[name] = state;\n\n            config.plugins.push(obj);\n        });\n\n    }\n\n    return config;\n\n}\n\nfunction optimizeFolder(dir, config, output) {\n\n    var svgo = new SVGO(config);\n\n    if (!config.quiet) {\n        console.log('Processing directory \\'' + dir + '\\':\\n');\n    }\n\n    // absoluted folder path\n    var path = PATH.resolve(dir);\n\n    // list folder content\n    FS.readdir(path, function(err, files) {\n\n        if (err) {\n            console.error(err);\n            return;\n        }\n\n        if (!files.length) {\n            console.log('Directory \\'' + dir + '\\' is empty.');\n            return;\n        }\n\n        var i = 0,\n            found = false;\n\n        function optimizeFile(file) {\n\n            // absoluted file path\n            var filepath = PATH.resolve(path, file);\n            var outfilepath = output ? PATH.resolve(output, file) : filepath;\n\n            // check if file name matches *.svg\n            if (regSVGFile.test(filepath)) {\n\n                found = true;\n                FS.readFile(filepath, 'utf8', function(err, data) {\n\n                    if (err) {\n                        console.error(err);\n                        return;\n                    }\n\n                    var startTime = Date.now(),\n                        time,\n                        inBytes = Buffer.byteLength(data, 'utf8'),\n                        outBytes;\n\n                    svgo.optimize(data, function(result) {\n\n                        if (result.error) {\n                            console.error(result.error);\n                            return;\n                        }\n\n                        outBytes = Buffer.byteLength(result.data, 'utf8');\n                        time = Date.now() - startTime;\n\n                        writeOutput();\n\n                        function writeOutput() {\n                            FS.writeFile(outfilepath, result.data, 'utf8', report);\n                        }\n\n                        function report(err) {\n\n                            if (err) {\n                                if (err.code === 'ENOENT') {\n                                    mkdirp(output, writeOutput);\n                                    return;\n                                } else if (err.code === 'ENOTDIR') {\n                                    console.error('Error: output \\'' + output + '\\' is not a directory.');\n                                    return;\n                                }\n                                console.error(err);\n                                return;\n                            }\n\n                            if (!config.quiet) {\n                                console.log(file + ':');\n\n                                // print time info\n                                printTimeInfo(time);\n\n                                // print optimization profit info\n                                printProfitInfo(inBytes, outBytes);\n                            }\n\n                            //move on to the next file\n                            if (++i < files.length) {\n                                optimizeFile(files[i]);\n                            }\n\n                        }\n\n                    });\n\n                });\n\n            }\n            //move on to the next file\n            else if (++i < files.length) {\n                optimizeFile(files[i]);\n            } else if (!found) {\n                console.log('No SVG files have been found.');\n            }\n\n\n        }\n\n        optimizeFile(files[i]);\n\n    });\n\n}\n\n\nvar showAvailablePlugins = function () {\n\n    var svgo = new SVGO(),\n        // Flatten an array of plugins grouped per type and sort alphabetically\n        list = Array.prototype.concat.apply([], svgo.config.plugins).sort(function(a, b) {\n            return a.name > b.name ? 1 : -1;\n        });\n\n    console.log('Currently available plugins:');\n\n    list.forEach(function (plugin) {\n        console.log(' [ ' + plugin.name.green + ' ] ' + plugin.description);\n    });\n\n    //console.log(JSON.stringify(svgo, null, 4));\n};\n"]}