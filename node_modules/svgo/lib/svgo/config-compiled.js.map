{"version":3,"sources":["config.js"],"names":[],"mappings":"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","file":"config-compiled.js","sourcesContent":["'use strict';\n\nvar FS = require('fs');\nvar yaml = require('js-yaml');\n\nvar EXTEND = require('whet.extend');\n\n/**\n * Read and/or extend/replace default config file,\n * prepare and optimize plugins array.\n *\n * @param {Object} [config] input config\n * @return {Object} output config\n */\nmodule.exports = function(config) {\n\n    var defaults;\n    config = typeof config == 'object' && config || {};\n\n    if (config.plugins && !Array.isArray(config.plugins)) {\n        return { error: 'Error: Invalid plugins list. Provided \\'plugins\\' in config should be an array.' };\n    }\n\n    if (config.full) {\n        defaults = config;\n\n        if (Array.isArray(defaults.plugins)) {\n            defaults.plugins = preparePluginsArray(defaults.plugins);\n        }\n    } else {\n        defaults = EXTEND({}, yaml.safeLoad(FS.readFileSync(__dirname + '/../../.svgo.yml', 'utf8')));\n        defaults.plugins = preparePluginsArray(defaults.plugins);\n        defaults = extendConfig(defaults, config);\n    }\n\n    if ('floatPrecision' in config && Array.isArray(defaults.plugins)) {\n        defaults.plugins.forEach(function(plugin) {\n            if (plugin.params && ('floatPrecision' in plugin.params)) {\n                // Don't touch default plugin params\n                plugin.params = EXTEND({}, plugin.params, { floatPrecision: config.floatPrecision });\n            }\n        });\n    }\n\n    if (Array.isArray(defaults.plugins)) {\n        defaults.plugins = optimizePluginsArray(defaults.plugins);\n    }\n\n    return defaults;\n\n};\n\n/**\n * Require() all plugins in array.\n *\n * @param {Array} plugins input plugins array\n * @return {Array} input plugins array of arrays\n */\nfunction preparePluginsArray(plugins) {\n\n    var plugin,\n        key;\n\n    return plugins.map(function(item) {\n\n        // {}\n        if (typeof item === 'object') {\n\n            key = Object.keys(item)[0];\n\n            // custom\n            if (typeof item[key] === 'object' && item[key].fn && typeof item[key].fn === 'function') {\n                plugin = setupCustomPlugin(key, item[key]);\n\n            } else {\n\n              plugin = EXTEND({}, require('../../plugins/' + key));\n\n              // name: {}\n              if (typeof item[key] === 'object') {\n                  plugin.params = EXTEND({}, plugin.params || {}, item[key]);\n                  plugin.active = true;\n\n              // name: false\n              } else if (item[key] === false) {\n                 plugin.active = false;\n\n              // name: true\n              } else if (item[key] === true) {\n                 plugin.active = true;\n              }\n\n              plugin.name = key;\n            }\n\n        // name\n        } else {\n\n            plugin = EXTEND({}, require('../../plugins/' + item));\n            plugin.name = item;\n\n        }\n\n        return plugin;\n\n    });\n\n}\n\n/**\n * Extend plugins with the custom config object.\n *\n * @param {Array} plugins input plugins\n * @param {Object} config config\n * @return {Array} output plugins\n */\nfunction extendConfig(defaults, config) {\n\n    var key;\n\n    // plugins\n    if (config.plugins) {\n\n        config.plugins.forEach(function(item) {\n\n            // {}\n            if (typeof item === 'object') {\n\n                key = Object.keys(item)[0];\n\n                // custom\n                if (typeof item[key] === 'object' && item[key].fn && typeof item[key].fn === 'function') {\n                    defaults.plugins.push(setupCustomPlugin(key, item[key]));\n\n                } else {\n                    defaults.plugins.forEach(function(plugin) {\n\n                        if (plugin.name === key) {\n                            // name: {}\n                            if (typeof item[key] === 'object') {\n                                plugin.params = EXTEND({}, plugin.params || {}, item[key]);\n                                plugin.active = true;\n\n                            // name: false\n                            } else if (item[key] === false) {\n                               plugin.active = false;\n\n                            // name: true\n                            } else if (item[key] === true) {\n                               plugin.active = true;\n                            }\n                        }\n                    });\n                }\n\n            }\n\n        });\n\n    }\n\n    defaults.multipass = config.multipass;\n\n    // svg2js\n    if (config.svg2js) {\n        defaults.svg2js = config.svg2js;\n    }\n\n    // js2svg\n    if (config.js2svg) {\n        defaults.js2svg = config.js2svg;\n    }\n\n    return defaults;\n\n}\n\n/**\n * Setup and enable a custom plugin\n *\n * @param {String} plugin name\n * @param {Object} custom plugin\n * @return {Array} enabled plugin\n */\nfunction setupCustomPlugin(name, plugin) {\n    plugin.active = true;\n    plugin.params = EXTEND({}, plugin.params || {});\n    plugin.name = name;\n\n    return plugin;\n}\n\n/**\n * Try to group sequential elements of plugins array.\n *\n * @param {Object} plugins input plugins\n * @return {Array} output plugins\n */\nfunction optimizePluginsArray(plugins) {\n\n    var prev;\n\n    return plugins.reduce(function(plugins, item) {\n        if (prev && item.type == prev[0].type) {\n            prev.push(item);\n        } else {\n            plugins.push(prev = [item]);\n        }\n        return plugins;\n    }, []);\n\n}\n"]}