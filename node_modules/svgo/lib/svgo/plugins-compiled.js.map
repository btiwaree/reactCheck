{"version":3,"sources":["plugins.js"],"names":[],"mappings":"AAAA;;;;;;;;;;;;AAWA,OAAO,OAAP,GAAiB,UAAS,IAAT,EAAe,OAAf,EAAwB;;AAErC,YAAQ,OAAR,CAAgB,UAAS,KAAT,EAAgB;;AAE5B,gBAAO,MAAM,CAAN,EAAS,IAAT;AACH,iBAAK,SAAL;AACI,uBAAO,QAAQ,IAAR,EAAc,KAAd,CAAP,CADJ;AAEI,sBAFJ;AADJ,iBAIS,gBAAL;AACI,uBAAO,QAAQ,IAAR,EAAc,KAAd,EAAqB,IAArB,CAAP,CADJ;AAEI,sBAFJ;AAJJ,iBAOS,MAAL;AACI,uBAAO,KAAK,IAAL,EAAW,KAAX,CAAP,CADJ;AAEI,sBAFJ;AAPJ,SAF4B;KAAhB,CAAhB,CAFqC;;AAkBrC,WAAO,IAAP,CAlBqC;CAAxB;;;;;;;;;;AA8BjB,SAAS,OAAT,CAAiB,IAAjB,EAAuB,OAAvB,EAAgC,OAAhC,EAAyC;;AAErC,aAAS,OAAT,CAAiB,KAAjB,EAAwB;;AAEpB,cAAM,OAAN,GAAgB,MAAM,OAAN,CAAc,MAAd,CAAqB,UAAS,IAAT,EAAe;;;AAGhD,gBAAI,WAAW,KAAK,OAAL,IAAgB,KAAK,IAAL,IAAa,eAAb,EAA8B;AACzD,wBAAQ,IAAR,EADyD;aAA7D;;;AAHgD,gBAQ5C,SAAS,IAAT,CAR4C;;AAUhD,iBAAK,IAAI,IAAI,CAAJ,EAAO,UAAU,IAAI,QAAQ,MAAR,EAAgB,GAA9C,EAAmD;AAC/C,oBAAI,SAAS,QAAQ,CAAR,CAAT,CAD2C;;AAG/C,oBAAI,OAAO,MAAP,IAAiB,OAAO,EAAP,CAAU,IAAV,EAAgB,OAAO,MAAP,CAAhB,KAAmC,KAAnC,EAA0C;AAC3D,6BAAS,KAAT,CAD2D;iBAA/D;aAHJ;;;AAVgD,gBAmB5C,CAAC,OAAD,IAAY,KAAK,OAAL,IAAgB,KAAK,IAAL,IAAa,eAAb,EAA8B;AAC1D,wBAAQ,IAAR,EAD0D;aAA9D;;AAIA,mBAAO,MAAP,CAvBgD;SAAf,CAArC,CAFoB;;AA6BpB,eAAO,KAAP,CA7BoB;KAAxB;;AAiCA,WAAO,QAAQ,IAAR,CAAP,CAnCqC;CAAzC;;;;;;;;;AA8CA,SAAS,IAAT,CAAc,IAAd,EAAoB,OAApB,EAA6B;;AAEzB,YAAQ,OAAR,CAAgB,UAAS,MAAT,EAAiB;AAC7B,YAAI,OAAO,MAAP,EAAe;AACf,mBAAO,OAAO,EAAP,CAAU,IAAV,EAAgB,OAAO,MAAP,CAAvB,CADe;SAAnB;KADY,CAAhB,CAFyB;;AAQzB,WAAO,IAAP,CARyB;CAA7B","file":"plugins-compiled.js","sourcesContent":["'use strict';\n\n/**\n * Plugins engine.\n *\n * @module plugins\n *\n * @param {Object} data input data\n * @param {Object} plugins plugins object from config\n * @return {Object} output data\n */\nmodule.exports = function(data, plugins) {\n\n    plugins.forEach(function(group) {\n\n        switch(group[0].type) {\n            case 'perItem':\n                data = perItem(data, group);\n                break;\n            case 'perItemReverse':\n                data = perItem(data, group, true);\n                break;\n            case 'full':\n                data = full(data, group);\n                break;\n        }\n\n    });\n\n    return data;\n\n};\n\n/**\n * Direct or reverse per-item loop.\n *\n * @param {Object} data input data\n * @param {Array} plugins plugins list to process\n * @param {Boolean} [reverse] reverse pass?\n * @return {Object} output data\n */\nfunction perItem(data, plugins, reverse) {\n\n    function monkeys(items) {\n\n        items.content = items.content.filter(function(item) {\n\n            // reverse pass\n            if (reverse && item.content && item.elem != 'foreignObject') {\n                monkeys(item);\n            }\n\n            // main filter\n            var filter = true;\n\n            for (var i = 0; filter && i < plugins.length; i++) {\n                var plugin = plugins[i];\n\n                if (plugin.active && plugin.fn(item, plugin.params) === false) {\n                    filter = false;\n                }\n            }\n\n            // direct pass\n            if (!reverse && item.content && item.elem != 'foreignObject') {\n                monkeys(item);\n            }\n\n            return filter;\n\n        });\n\n        return items;\n\n    }\n\n    return monkeys(data);\n\n}\n\n/**\n * \"Full\" plugins.\n *\n * @param {Object} data input data\n * @param {Array} plugins plugins list to process\n * @return {Object} output data\n */\nfunction full(data, plugins) {\n\n    plugins.forEach(function(plugin) {\n        if (plugin.active) {\n            data = plugin.fn(data, plugin.params);\n        }\n    });\n\n    return data;\n\n}\n"]}