{"version":3,"sources":["Parser.test.js"],"names":[],"mappings":"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","file":"Parser.test-compiled.js","sourcesContent":["/*globals describe it */\r\n\r\nrequire(\"should\");\r\nvar Parser = require(\"../\");\r\n\r\nvar testdata = [\r\n\t{\r\n\t\tname: \"simple string\",\r\n\t\tstates: {\r\n\t\t\t\"start\": {\r\n\t\t\t\t\"[d-gm-rv]+\": function(match, index) {\r\n\t\t\t\t\tif(!this.data) this.data = [];\r\n\t\t\t\t\tthis.data.push({\r\n\t\t\t\t\t\tmatch: match,\r\n\t\t\t\t\t\tindex: index\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tstring: \"abcdefghijklmnopqrstuvwxyz\",\r\n\t\texpected: {\r\n\t\t\tdata: [\r\n\t\t\t\t{ match: \"defg\", index: 3 },\r\n\t\t\t\t{ match: \"mnopqr\", index: 12 },\r\n\t\t\t\t{ match: \"v\", index: 21 }\r\n\t\t\t]\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\tname: \"state switing\",\r\n\t\tstates: {\r\n\t\t\t\"number\": {\r\n\t\t\t\t\"([0-9]+)\": function(match, number) {\r\n\t\t\t\t\tif(!this.data) this.data = {};\r\n\t\t\t\t\tthis.data[this.ident] = +number;\r\n\t\t\t\t\tdelete this.ident;\r\n\t\t\t\t\treturn \"start\";\r\n\t\t\t\t},\r\n\t\t\t\t\"-\\\\?\": true,\r\n\t\t\t\t\"\\\\?\": \"start\"\r\n\t\t\t},\r\n\t\t\t\"start\": {\r\n\t\t\t\t\"([a-z]+)\": function(match, name) {\r\n\t\t\t\t\tthis.ident = name;\r\n\t\t\t\t\treturn \"number\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tstring: \"a 1 b 2 c f 3 d ? e -? 4\",\r\n\t\texpected: {\r\n\t\t\tdata: {\r\n\t\t\t\ta: 1, b: 2, c: 3, e: 4\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\tname: \"state array\",\r\n\t\tstates: {\r\n\t\t\t\"start\": [\r\n\t\t\t\t{ \"a\": function() { this.a = true; } },\r\n\t\t\t\t{\r\n\t\t\t\t\t\"b\": function() { this.b = true; },\r\n\t\t\t\t\t\"c\": function() { this.c = true; }\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\tstring: \"hello abc\",\r\n\t\texpected: {\r\n\t\t\ta: true, b: true, c: true\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\tname: \"reference other states\",\r\n\t\tstates: {\r\n\t\t\t\"start\": [\r\n\t\t\t\t{ \"a\": function() { this.a = true; } },\r\n\t\t\t\t\"bc\"\r\n\t\t\t],\r\n\t\t\t\"bc\": {\r\n\t\t\t\t\"b\": function() { this.b = true; },\r\n\t\t\t\t\"c\": function() { this.c = true; }\r\n\t\t\t}\r\n\t\t},\r\n\t\tstring: \"hello abc\",\r\n\t\texpected: {\r\n\t\t\ta: true, b: true, c: true\r\n\t\t}\r\n\t}\r\n];\r\n\r\ndescribe(\"Parser\", function() {\r\n\ttestdata.forEach(function(testcase) {\r\n\t\tit(\"should parse \" + testcase.name, function() {\r\n\t\t\tvar parser = new Parser(testcase.states);\r\n\t\t\tvar actual = parser.parse(\"start\", testcase.string, {});\r\n\t\t\tactual.should.be.eql(testcase.expected);\r\n\t\t});\r\n\t});\r\n\r\n\tit(\"should default context to empty object\", function() {\r\n\t\tvar parser = new Parser({\r\n\t\t\t\"a\": {\r\n\t\t\t\t\"a\": function() {\r\n\t\t\t\t\tthis.should.be.eql({});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar result = parser.parse(\"a\", \"a\");\r\n\t\tresult.should.be.eql({});\r\n\t});\r\n\r\n\tit(\"should error for unexpected format\", function() {\r\n\t\t(function() {\r\n\t\t\tvar parser = new Parser({\r\n\t\t\t\t\"a\": 123\r\n\t\t\t});\r\n\t\t\treturn parser;\r\n\t\t}).should.throw();\r\n\t});\r\n\r\n\tit(\"should error for not existing state\", function() {\r\n\t\tvar parser = new Parser({\r\n\t\t\t\"a\": {\r\n\t\t\t\t\"a\": \"b\"\r\n\t\t\t}\r\n\t\t});\r\n\t\t(function() {\r\n\t\t\treturn parser.parse(\"a\", \"a\");\r\n\t\t}).should.throw();\r\n\t});\r\n});\r\n"]}