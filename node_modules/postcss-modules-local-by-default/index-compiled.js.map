{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["var postcss = require('postcss');\nvar Tokenizer = require('css-selector-tokenizer');\n\nfunction normalizeNodeArray(nodes) {\n  var array = [];\n  nodes.forEach(function(x) {\n    if(Array.isArray(x)) {\n      normalizeNodeArray(x).forEach(function(item) {\n        array.push(item);\n      });\n    } else if(x) {\n      array.push(x);\n    }\n  });\n  if(array.length > 0 && array[array.length - 1].type === 'spacing') {\n    array.pop();\n  }\n  return array;\n}\n\nfunction localizeNode(node, context) {\n  if(context.ignoreNextSpacing && node.type !== 'spacing') {\n    throw new Error('Missing whitespace after :' + context.ignoreNextSpacing);\n  }\n  if(context.enforceNoSpacing && node.type === 'spacing') {\n    throw new Error('Missing whitespace before :' + context.enforceNoSpacing);\n  }\n\n  var newNodes;\n  switch(node.type) {\n    case 'selectors':\n      var resultingGlobal;\n      context.hasPureGlobals = false;\n      newNodes = node.nodes.map(function(n) {\n        var nContext = {\n          global: context.global,\n          lastWasSpacing: true,\n          hasLocals: false,\n          explicit: false\n        };\n        n = localizeNode(n, nContext);\n        if(typeof resultingGlobal === 'undefined') {\n          resultingGlobal = nContext.global;\n        } else if(resultingGlobal !== nContext.global) {\n          throw new Error('Inconsistent rule global/local result in rule \"' +\n            Tokenizer.stringify(node) + '\" (multiple selectors must result in the same mode for the rule)');\n        }\n        if(!nContext.hasLocals) {\n          context.hasPureGlobals = true;\n        }\n        return n;\n      });\n      context.global = resultingGlobal;\n      node = Object.create(node);\n      node.nodes = normalizeNodeArray(newNodes);\n      break;\n\n    case 'selector':\n      newNodes = node.nodes.map(function(n) {\n        return localizeNode(n, context);\n      });\n      node = Object.create(node);\n      node.nodes = normalizeNodeArray(newNodes);\n      break;\n\n    case 'spacing':\n      if(context.ignoreNextSpacing) {\n        context.ignoreNextSpacing = false;\n        context.lastWasSpacing = false;\n        context.enforceNoSpacing = false;\n        return null;\n      }\n      context.lastWasSpacing = true;\n      return node;\n\n    case 'pseudo-class':\n      if(node.name === 'local' || node.name === 'global') {\n        if(context.inside) {\n          throw new Error('A :' + node.name + ' is not allowed inside of a :' + context.inside + '(...)');\n        }\n        context.ignoreNextSpacing = context.lastWasSpacing ? node.name : false;\n        context.enforceNoSpacing = context.lastWasSpacing ? false : node.name;\n        context.global = (node.name === 'global');\n        context.explicit = true;\n        return null;\n      }\n      break;\n\n    case 'nested-pseudo-class':\n      var subContext;\n      if(node.name === 'local' || node.name === 'global') {\n        if(context.inside) {\n          throw new Error('A :' + node.name + '(...) is not allowed inside of a :' + context.inside + '(...)');\n        }\n        subContext = {\n          global: (node.name === 'global'),\n          inside: node.name,\n          hasLocals: false,\n          explicit: true\n        };\n        node = node.nodes.map(function(n) {\n          return localizeNode(n, subContext);\n        });\n        // don't leak spacing\n        node[0].before = undefined;\n        node[node.length - 1].after = undefined;\n      } else {\n        subContext = {\n          global: context.global,\n          inside: context.inside,\n          lastWasSpacing: true,\n          hasLocals: false,\n          explicit: context.explicit\n        };\n        newNodes = node.nodes.map(function(n) {\n          return localizeNode(n, subContext);\n        });\n        node = Object.create(node);\n        node.nodes = normalizeNodeArray(newNodes);\n      }\n      if(subContext.hasLocals) {\n        context.hasLocals = true;\n      }\n      break;\n\n    case 'id':\n    case 'class':\n      if(!context.global) {\n        node = {\n          type: 'nested-pseudo-class',\n          name: 'local',\n          nodes: [node]\n        };\n        context.hasLocals = true;\n      }\n      break;\n  }\n\n  // reset context\n  context.lastWasSpacing = false;\n  context.ignoreNextSpacing = false;\n  context.enforceNoSpacing = false;\n  return node;\n}\n\nfunction localizeDeclNode(node, context) {\n  var newNode;\n  switch(node.type) {\n    case 'item':\n      if(context.localizeNextItem) {\n        newNode = Object.create(node);\n        newNode.name = ':local(' + newNode.name + ')';\n        context.localizeNextItem = false;\n        return newNode;\n      }\n      break;\n\n    case 'nested-item':\n      var newNodes = node.nodes.map(function(n) {\n        return localizeDeclValue(n, context);\n      });\n      node = Object.create(node);\n      node.nodes = newNodes;\n      break;\n\n    case 'url':\n      if(context.options && context.options.rewriteUrl) {\n        newNode = Object.create(node);\n        newNode.url = context.options.rewriteUrl(context.global, node.url);\n        return newNode;\n      }\n      break;\n  }\n  return node;\n}\n\nfunction localizeDeclValue(valueNode, context) {\n  var newValueNode = Object.create(valueNode);\n  newValueNode.nodes = valueNode.nodes.map(function(node) {\n    return localizeDeclNode(node, context);\n  });\n  return newValueNode;\n}\n\nfunction localizeDecl(decl, context) {\n  var valuesNode = Tokenizer.parseValues(decl.value);\n  var localizeName = /animation(-name)?$/.test(decl.prop);\n  var newValuesNode = Object.create(valuesNode);\n  newValuesNode.nodes = valuesNode.nodes.map(function(valueNode) {\n    var subContext = {\n      options: context.options,\n      global: context.global,\n      localizeNextItem: localizeName && !context.global\n    };\n    return localizeDeclValue(valueNode, subContext);\n  });\n  decl.value = Tokenizer.stringifyValues(newValuesNode);\n}\n\nmodule.exports = postcss.plugin('postcss-modules-local-by-default', function (options) {\n  if (typeof options !== 'object') {\n    options = {}; // If options is undefined or not an object the plugin fails\n  }\n  if(options && options.mode) {\n    if(options.mode !== 'global' && options.mode !== 'local' && options.mode !== 'pure') {\n      throw new Error('options.mode must be either \"global\", \"local\" or \"pure\" (default \"local\")');\n    }\n  }\n  var pureMode = options && options.mode === 'pure';\n  var globalMode = options && options.mode === 'global';\n  return function(css) {\n    css.walkAtRules(function(atrule) {\n      if(/keyframes$/.test(atrule.name)) {\n        var globalMatch = /^\\s*:global\\s*\\((.+)\\)\\s*$/.exec(atrule.params);\n        var localMatch = /^\\s*:local\\s*\\((.+)\\)\\s*$/.exec(atrule.params);\n        var globalKeyframes = globalMode;\n        if(globalMatch) {\n          if(pureMode) {\n            throw atrule.error('@keyframes :global(...) is not allowed in pure mode');\n          }\n          atrule.params = globalMatch[1];\n          globalKeyframes = true;\n        } else if(localMatch) {\n          atrule.params = localMatch[0];\n          globalKeyframes = false;\n        } else if(!globalMode) {\n          atrule.params = ':local(' + atrule.params + ')';\n        }\n        atrule.walkDecls(function(decl) {\n          localizeDecl(decl, {\n            options: options,\n            global: globalKeyframes\n          });\n        });\n      } else if(atrule.nodes) {\n        atrule.nodes.forEach(function(decl) {\n          if(decl.type === 'decl') {\n            localizeDecl(decl, {\n              options: options,\n              global: globalMode\n            });\n          }\n        });\n      }\n    });\n    css.walkRules(function(rule) {\n      if(rule.parent.type === 'atrule' && /keyframes$/.test(rule.parent.name)) {\n        // ignore keyframe rules\n        return;\n      }\n      var selector = Tokenizer.parse(rule.selector);\n      var context = {\n        options: options,\n        global: globalMode,\n        hasPureGlobals: false\n      };\n      var newSelector;\n      try {\n        newSelector = localizeNode(selector, context);\n      } catch(e) {\n        throw rule.error(e.message);\n      }\n      if(pureMode && context.hasPureGlobals) {\n        throw rule.error('Selector \"' + Tokenizer.stringify(selector) + '\" is not pure ' +\n          '(pure selectors must contain at least one local class or id)');\n      }\n      rule.nodes.forEach(function(decl) {\n        localizeDecl(decl, context);\n      });\n      rule.selector = Tokenizer.stringify(newSelector);\n    });\n  };\n});\n"]}