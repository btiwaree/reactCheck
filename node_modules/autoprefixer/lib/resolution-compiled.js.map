{"version":3,"sources":["resolution.js"],"names":[],"mappings":"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","file":"resolution-compiled.js","sourcesContent":["(function() {\n  var Prefixer, Resolution, n2f, regexp, split, utils,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  Prefixer = require('./prefixer');\n\n  utils = require('./utils');\n\n  n2f = require('num2fraction');\n\n  regexp = /(min|max)-resolution\\s*:\\s*\\d*\\.?\\d+(dppx|dpi)/gi;\n\n  split = /(min|max)-resolution(\\s*:\\s*)(\\d*\\.?\\d+)(dppx|dpi)/i;\n\n  Resolution = (function(superClass) {\n    extend(Resolution, superClass);\n\n    function Resolution() {\n      return Resolution.__super__.constructor.apply(this, arguments);\n    }\n\n    Resolution.prototype.prefixName = function(prefix, name) {\n      return name = prefix === '-moz-' ? name + '--moz-device-pixel-ratio' : prefix + name + '-device-pixel-ratio';\n    };\n\n    Resolution.prototype.prefixQuery = function(prefix, name, colon, value, units) {\n      if (units === 'dpi') {\n        value = Number(value / 96);\n      }\n      if (prefix === '-o-') {\n        value = n2f(value);\n      }\n      return this.prefixName(prefix, name) + colon + value;\n    };\n\n    Resolution.prototype.clean = function(rule) {\n      var j, len, prefix, ref;\n      if (!this.bad) {\n        this.bad = [];\n        ref = this.prefixes;\n        for (j = 0, len = ref.length; j < len; j++) {\n          prefix = ref[j];\n          this.bad.push(this.prefixName(prefix, 'min'));\n          this.bad.push(this.prefixName(prefix, 'max'));\n        }\n      }\n      return rule.params = utils.editList(rule.params, (function(_this) {\n        return function(queries) {\n          return queries.filter(function(query) {\n            return _this.bad.every(function(i) {\n              return query.indexOf(i) === -1;\n            });\n          });\n        };\n      })(this));\n    };\n\n    Resolution.prototype.process = function(rule) {\n      var parent, prefixes;\n      parent = this.parentPrefix(rule);\n      prefixes = parent ? [parent] : this.prefixes;\n      return rule.params = utils.editList(rule.params, (function(_this) {\n        return function(origin, prefixed) {\n          var j, k, len, len1, prefix, processed, query;\n          for (j = 0, len = origin.length; j < len; j++) {\n            query = origin[j];\n            if (query.indexOf('min-resolution') === -1 && query.indexOf('max-resolution') === -1) {\n              prefixed.push(query);\n              continue;\n            }\n            for (k = 0, len1 = prefixes.length; k < len1; k++) {\n              prefix = prefixes[k];\n              if (prefix === '-moz-' && rule.params.indexOf('dpi') !== -1) {\n                continue;\n              } else {\n                processed = query.replace(regexp, function(str) {\n                  var parts;\n                  parts = str.match(split);\n                  return _this.prefixQuery(prefix, parts[1], parts[2], parts[3], parts[4]);\n                });\n                prefixed.push(processed);\n              }\n            }\n            prefixed.push(query);\n          }\n          return utils.uniq(prefixed);\n        };\n      })(this));\n    };\n\n    return Resolution;\n\n  })(Prefixer);\n\n  module.exports = Resolution;\n\n}).call(this);\n"]}