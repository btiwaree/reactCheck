{"version":3,"sources":["perf.js"],"names":[],"mappings":"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","file":"perf-compiled.js","sourcesContent":["var assert = require('assert');\n\nvar uuid = require('../');\n\nvar log = console.log;\n\nvar generators = {\n  v1: uuid.v1,\n  v4: uuid.v4\n};\n\nvar UUID_FORMAT = {\n  v1: /[0-9a-f]{8}-[0-9a-f]{4}-1[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}/i,\n  v4: /[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}/i\n};\n\nvar N = 1e4;\n\n// Get %'age an actual value differs from the ideal value\nfunction divergence(actual, ideal) {\n  return Math.round(100*100*(actual - ideal)/ideal)/100;\n}\n\nfunction rate(msg, t) {\n  log(msg + ': ' + (N / (Date.now() - t) * 1e3 | 0) + ' uuids\\/second');\n}\n\nfor (var version in generators) {\n  var counts = {}, max = 0;\n  var generator = generators[version];\n  var format = UUID_FORMAT[version];\n\n  log('\\nSanity check ' + N + ' ' + version + ' uuids');\n  for (var i = 0, ok = 0; i < N; i++) {\n    id = generator();\n    if (!format.test(id)) {\n      throw Error(id + ' is not a valid UUID string');\n    }\n\n    if (id != uuid.unparse(uuid.parse(id))) {\n      assert(fail, id + ' is not a valid id');\n    }\n\n    // Count digits for our randomness check\n    if (version == 'v4') {\n      var digits = id.replace(/-/g, '').split('');\n      for (var j = digits.length-1; j >= 0; j--) {\n        var c = digits[j];\n        max = Math.max(max, counts[c] = (counts[c] || 0) + 1);\n      }\n    }\n  }\n\n  // Check randomness for v4 UUIDs\n  if (version == 'v4') {\n    // Limit that we get worried about randomness. (Purely empirical choice, this!)\n    var limit = 2*100*Math.sqrt(1/N);\n\n    log('\\nChecking v4 randomness.  Distribution of Hex Digits (% deviation from ideal)');\n\n    for (var i = 0; i < 16; i++) {\n      var c = i.toString(16);\n      var bar = '', n = counts[c], p = Math.round(n/max*100|0);\n\n      // 1-3,5-8, and D-F: 1:16 odds over 30 digits\n      var ideal = N*30/16;\n      if (i == 4) {\n        // 4: 1:1 odds on 1 digit, plus 1:16 odds on 30 digits\n        ideal = N*(1 + 30/16);\n      } else if (i >= 8 && i <= 11) {\n        // 8-B: 1:4 odds on 1 digit, plus 1:16 odds on 30 digits\n        ideal = N*(1/4 + 30/16);\n      } else {\n        // Otherwise: 1:16 odds on 30 digits\n        ideal = N*30/16;\n      }\n      var d = divergence(n, ideal);\n\n      // Draw bar using UTF squares (just for grins)\n      var s = n/max*50 | 0;\n      while (s--) bar += '=';\n\n      assert(Math.abs(d) < limit, c + ' |' + bar + '| ' + counts[c] + ' (' + d + '% < ' + limit + '%)');\n    }\n  }\n}\n\n// Perf tests\nfor (var version in generators) {\n  log('\\nPerformance testing ' + version + ' UUIDs');\n  var generator = generators[version];\n  var buf = new uuid.BufferClass(16);\n\n  for (var i = 0, t = Date.now(); i < N; i++) generator();\n  rate('uuid.' + version + '()', t);\n\n  for (var i = 0, t = Date.now(); i < N; i++) generator('binary');\n  rate('uuid.' + version + '(\\'binary\\')', t);\n\n  for (var i = 0, t = Date.now(); i < N; i++) generator('binary', buf);\n  rate('uuid.' + version + '(\\'binary\\', buffer)', t);\n}\n"]}