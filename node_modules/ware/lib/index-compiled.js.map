{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;AAIA,IAAI,QAAQ,GAAG,KAAH;AACZ,IAAI,OAAO,QAAQ,SAAR,CAAP;;;;;;AAMJ,OAAO,OAAP,GAAiB,IAAjB;;;;;;;;AAQA,SAAS,IAAT,CAAe,GAAf,EAAoB;AAClB,QAAM,GAAN,CADkB;CAApB;;;;;;;;AAUA,SAAS,IAAT,CAAe,EAAf,EAAmB;AACjB,MAAI,EAAE,gBAAgB,IAAhB,CAAF,EAAyB,OAAO,IAAI,IAAJ,CAAS,EAAT,CAAP,CAA7B;AACA,OAAK,GAAL,GAAW,EAAX,CAFiB;AAGjB,MAAI,EAAJ,EAAQ,KAAK,GAAL,CAAS,EAAT,EAAR;CAHF;;;;;;;;;AAaA,KAAK,SAAL,CAAe,GAAf,GAAqB,UAAU,EAAV,EAAc;AACjC,MAAI,cAAc,IAAd,EAAoB;AACtB,WAAO,KAAK,GAAL,CAAS,GAAG,GAAH,CAAhB,CADsB;GAAxB;;AAIA,MAAI,cAAc,KAAd,EAAqB;AACvB,SAAK,IAAI,IAAI,CAAJ,EAAO,CAAX,EAAc,IAAI,GAAG,GAAH,CAAJ,GAAc,KAAK,GAAL,CAAS,CAAT,EAAjC;AACA,WAAO,IAAP,CAFuB;GAAzB;;AAKA,OAAK,GAAL,CAAS,IAAT,CAAc,EAAd,EAViC;AAWjC,SAAO,IAAP,CAXiC;CAAd;;;;;;;;;;AAsBrB,KAAK,SAAL,CAAe,GAAf,GAAqB,YAAY;AAC/B,MAAI,MAAM,KAAK,GAAL,CADqB;AAE/B,MAAI,MAAM,IAAN,CAF2B;AAG/B,MAAI,IAAI,CAAJ,CAH2B;AAI/B,MAAI,OAAO,UAAU,UAAU,MAAV,GAAmB,CAAnB,CAAjB,CAJ2B;AAK/B,MAAI,OAAO,cAAc,OAAO,IAAP,IAAe,IAA7B,CALoB;AAM/B,MAAI,OAAO,OACP,MAAM,IAAN,CAAW,SAAX,EAAsB,CAAtB,EAAyB,UAAU,MAAV,GAAmB,CAAnB,CADlB,GAEP,MAAM,IAAN,CAAW,SAAX,CAFO;;;AANoB,WAWtB,IAAT,CAAe,GAAf,EAAoB;AAClB,QAAI,GAAJ,EAAS,OAAO,CAAC,QAAQ,IAAR,CAAD,CAAe,GAAf,CAAP,CAAT;AACA,QAAI,KAAK,IAAI,GAAJ,CAAL,CAFc;AAGlB,QAAI,MAAM,MAAM,IAAN,CAAW,IAAX,CAAN,CAHc;;AAKlB,QAAI,CAAC,EAAD,EAAK;AACP,aAAO,QAAQ,KAAK,KAAL,CAAW,IAAX,EAAiB,CAAC,IAAD,EAAO,MAAP,CAAc,IAAd,CAAjB,CAAR,CADA;KAAT;;AAIA,SAAK,EAAL,EAAS,IAAT,EAAe,KAAf,CAAqB,GAArB,EAA0B,GAA1B,EATkB;GAApB;;AAYA,SAvB+B;;AAyB/B,SAAO,IAAP,CAzB+B;CAAZ","file":"index-compiled.js","sourcesContent":["/**\n * Module Dependencies\n */\n\nvar slice = [].slice;\nvar wrap = require('wrap-fn');\n\n/**\n * Expose `Ware`.\n */\n\nmodule.exports = Ware;\n\n/**\n * Throw an error.\n *\n * @param {Error} error\n */\n\nfunction fail (err) {\n  throw err;\n}\n\n/**\n * Initialize a new `Ware` manager, with optional `fns`.\n *\n * @param {Function or Array or Ware} fn (optional)\n */\n\nfunction Ware (fn) {\n  if (!(this instanceof Ware)) return new Ware(fn);\n  this.fns = [];\n  if (fn) this.use(fn);\n}\n\n/**\n * Use a middleware `fn`.\n *\n * @param {Function or Array or Ware} fn\n * @return {Ware}\n */\n\nWare.prototype.use = function (fn) {\n  if (fn instanceof Ware) {\n    return this.use(fn.fns);\n  }\n\n  if (fn instanceof Array) {\n    for (var i = 0, f; f = fn[i++];) this.use(f);\n    return this;\n  }\n\n  this.fns.push(fn);\n  return this;\n};\n\n/**\n * Run through the middleware with the given `args` and optional `callback`.\n *\n * @param {Mixed} args...\n * @param {Function} callback (optional)\n * @return {Ware}\n */\n\nWare.prototype.run = function () {\n  var fns = this.fns;\n  var ctx = this;\n  var i = 0;\n  var last = arguments[arguments.length - 1];\n  var done = 'function' == typeof last && last;\n  var args = done\n    ? slice.call(arguments, 0, arguments.length - 1)\n    : slice.call(arguments);\n\n  // next step\n  function next (err) {\n    if (err) return (done || fail)(err);\n    var fn = fns[i++];\n    var arr = slice.call(args);\n\n    if (!fn) {\n      return done && done.apply(null, [null].concat(args));\n    }\n\n    wrap(fn, next).apply(ctx, arr);\n  }\n\n  next();\n\n  return this;\n};\n"]}