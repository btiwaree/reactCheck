{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _postcssValueParser = require('postcss-value-parser');\n\nvar _postcssValueParser2 = _interopRequireDefault(_postcssValueParser);\n\nvar _postcss = require('postcss');\n\nvar _postcss2 = _interopRequireDefault(_postcss);\n\nvar _encode = require('./lib/encode');\n\nvar _encode2 = _interopRequireDefault(_encode);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction isNum(node) {\n    return (0, _postcssValueParser.unit)(node.value);\n}\n\nfunction transformAtRule(css, atRuleRegex, propRegex, encoder) {\n    var cache = {};\n    var ruleCache = [];\n    var declCache = [];\n    // Encode at rule names and cache the result\n    css.walk(function (node) {\n        if (node.type === 'atrule' && atRuleRegex.test(node.name)) {\n            if (!cache[node.params]) {\n                cache[node.params] = {\n                    ident: encoder(node.params, Object.keys(cache).length),\n                    count: 0\n                };\n            }\n            node.params = cache[node.params].ident;\n            ruleCache.push(node);\n        } else if (node.type === 'decl' && propRegex.test(node.prop)) {\n            declCache.push(node);\n        }\n    });\n    // Iterate each property and change their names\n    declCache.forEach(function (decl) {\n        decl.value = (0, _postcssValueParser2.default)(decl.value).walk(function (node) {\n            if (node.type === 'word' && node.value in cache) {\n                cache[node.value].count++;\n                node.value = cache[node.value].ident;\n            } else if (node.type === 'space') {\n                node.value = ' ';\n            } else if (node.type === 'div') {\n                node.before = node.after = '';\n            }\n        }).toString();\n    });\n    // Ensure that at rules with no references to them are left unchanged\n    ruleCache.forEach(function (rule) {\n        Object.keys(cache).forEach(function (key) {\n            var k = cache[key];\n            if (k.ident === rule.params && !k.count) {\n                rule.params = key;\n            }\n        });\n    });\n}\n\nfunction transformDecl(css, propOneRegex, propTwoRegex, encoder) {\n    var cache = {};\n    var declOneCache = [];\n    var declTwoCache = [];\n    css.walkDecls(function (decl) {\n        if (propOneRegex.test(decl.prop)) {\n            decl.value = (0, _postcssValueParser2.default)(decl.value).walk(function (node) {\n                if (node.type === 'word' && !isNum(node)) {\n                    if (!cache[node.value]) {\n                        cache[node.value] = {\n                            ident: encoder(node.value, Object.keys(cache).length),\n                            count: 0\n                        };\n                    }\n                    node.value = cache[node.value].ident;\n                } else if (node.type === 'space') {\n                    node.value = ' ';\n                }\n            });\n            declOneCache.push(decl);\n        } else if (propTwoRegex.test(decl.prop)) {\n            declTwoCache.push(decl);\n        }\n    });\n    declTwoCache.forEach(function (decl) {\n        decl.value = (0, _postcssValueParser2.default)(decl.value).walk(function (node) {\n            if (node.type === 'function') {\n                if (node.value === 'counter' || node.value === 'counters') {\n                    (0, _postcssValueParser.walk)(node.nodes, function (n) {\n                        if (n.type === 'word' && n.value in cache) {\n                            cache[n.value].count++;\n                            n.value = cache[n.value].ident;\n                        } else if (n.type === 'div') {\n                            n.before = n.after = '';\n                        }\n                    });\n                }\n                return false;\n            }\n            if (node.type === 'space') {\n                node.value = ' ';\n            }\n        }).toString();\n    });\n    declOneCache.forEach(function (decl) {\n        decl.value = decl.value.walk(function (node) {\n            if (node.type === 'word' && !isNum(node)) {\n                Object.keys(cache).forEach(function (key) {\n                    var k = cache[key];\n                    if (k.ident === node.value && !k.count) {\n                        node.value = key;\n                    }\n                });\n            }\n        }).toString();\n    });\n}\n\nexports.default = _postcss2.default.plugin('postcss-reduce-idents', function () {\n    var opts = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n    var encoder = opts.encoder || _encode2.default;\n    return function (css) {\n        if (opts.counter !== false) {\n            transformDecl(css, /counter-(reset|increment)/, /content/, encoder);\n        }\n        if (opts.keyframes !== false) {\n            transformAtRule(css, /keyframes/, /animation/, encoder);\n        }\n        if (opts.counterStyle !== false) {\n            transformAtRule(css, /counter-style/, /(list-style|system)/, encoder);\n        }\n    };\n});\nmodule.exports = exports['default'];"]}