{"version":3,"sources":["writable_test.js"],"names":[],"mappings":";AACA,IAAI,WAAW,QAAQ,mBAAR,EAA6B,QAA7B;AACf,IAAI,gBAAgB,QAAQ,UAAR,EAAoB,aAApB;;AAEpB,QAAQ,QAAR,GAAmB;AACjB,WAAS,UAAS,IAAT,EAAe;AACtB,SAAK,MAAL,CAAY,CAAZ,EADsB;;AAGtB,QAAI,WAAW,IAAI,QAAJ,CAAa,UAAS,OAAT,EAAkB;AAC3C,WAAK,EAAL,CAAQ,gBAAgB,QAAhB,EAA0B,gDAAlC,EAD2C;AAE3C,WAAK,KAAL,CAAW,QAAQ,QAAR,EAAkB,OAA7B,EAAsC,qDAAtC,EAF2C;AAG3C,WAAK,EAAL,GAAU,IAAV,CAH2C;AAI3C,aAAO,IAAI,aAAJ,CAAkB,EAAlB,CAAP,CAJ2C;KAAlB,EAKzB,EAAC,UAAU,OAAV,EALW,CAAX,CAHkB;;AAUtB,aAAS,KAAT,CAAe,MAAf,EAVsB;;AAYtB,SAAK,EAAL,CAAQ,SAAS,EAAT,CAAR,CAZsB;;AActB,SAAK,IAAL,GAdsB;GAAf;AAgBT,SAAO,UAAS,IAAT,EAAe;AACpB,QAAI,WAAW,CAAE,SAAF,EAAa,SAAb,CAAX,CADgB;AAEpB,QAAI,SAAS,EAAT,CAFgB;;AAIpB,SAAK,MAAL,CAAY,CAAZ,EAJoB;;AAMpB,QAAI,QAAQ,IAAI,aAAJ,CAAkB,MAAlB,CAAR,CANgB;;AAQpB,aAAS,OAAT,CAAiB,UAAS,IAAT,EAAe;AAC9B,YAAM,KAAN,CAAY,IAAI,MAAJ,CAAW,IAAX,CAAZ,EAD8B;KAAf,CAAjB,CARoB;AAWpB,SAAK,IAAL,GAXoB;GAAf;AAaP,YAAU,UAAS,IAAT,EAAe;AACvB,QAAI,WAAW,CAAE,SAAF,EAAa,SAAb,CAAX,CADmB;AAEvB,QAAI,SAAS,EAAT,CAFmB;AAGvB,QAAI,eAAe,KAAf,CAHmB;;AAKvB,SAAK,MAAL,CAAY,CAAZ,EALuB;;AAOvB,QAAI,WAAW,IAAI,QAAJ,CAAa,YAAW;AACrC,qBAAe,IAAf,CADqC;AAErC,aAAO,IAAI,aAAJ,CAAkB,MAAlB,CAAP,CAFqC;KAAX,CAAxB,CAPmB;;AAYvB,SAAK,KAAL,CAAW,YAAX,EAAyB,KAAzB,EAAgC,6DAAhC,EAZuB;;AAcvB,aAAS,EAAT,CAAY,KAAZ,EAAmB,YAAW;AAC5B,WAAK,KAAL,CAAW,OAAO,IAAP,CAAY,EAAZ,CAAX,EAA4B,SAAS,IAAT,CAAc,EAAd,CAA5B,EAA+C,8DAA/C,EAD4B;AAE5B,WAAK,IAAL,GAF4B;KAAX,CAAnB,CAduB;;AAmBvB,aAAS,OAAT,CAAiB,UAAS,IAAT,EAAe;AAC9B,eAAS,KAAT,CAAe,IAAI,MAAJ,CAAW,IAAX,CAAf,EAD8B;KAAf,CAAjB,CAnBuB;AAsBvB,aAAS,GAAT,GAtBuB;GAAf;CA9BZ","file":"writable_test-compiled.js","sourcesContent":["\nvar Writable = require('../lib/lazystream').Writable;\nvar DummyWritable = require('./helper').DummyWritable;\n\nexports.writable = {\n  options: function(test) {\n    test.expect(3);\n\n    var writable = new Writable(function(options) {\n       test.ok(this instanceof Writable, \"Writable should bind itself to callback's this\");\n       test.equal(options.encoding, \"utf-8\", \"Writable should make options accessible to callback\");\n       this.ok = true;\n       return new DummyWritable([]);\n    }, {encoding: \"utf-8\"});\n\n    writable.write(\"test\");\n\n    test.ok(writable.ok);\n\n    test.done();\n  },\n  dummy: function(test) {\n    var expected = [ 'line1\\n', 'line2\\n' ];\n    var actual = [];\n    \n    test.expect(0);\n\n    var dummy = new DummyWritable(actual);\n\n    expected.forEach(function(item) {\n      dummy.write(new Buffer(item));\n    });\n    test.done();\n  },\n  streams2: function(test) {\n    var expected = [ 'line1\\n', 'line2\\n' ];\n    var actual = [];\n    var instantiated = false;\n\n    test.expect(2);\n\n    var writable = new Writable(function() {\n      instantiated = true;\n      return new DummyWritable(actual);\n    });\n\n    test.equal(instantiated, false, 'DummyWritable should only be instantiated when it is needed');\n\n    writable.on('end', function() {\n      test.equal(actual.join(''), expected.join(''), 'Writable should not change the data of the underlying stream');\n      test.done();\n    });\n\n    expected.forEach(function(item) {\n      writable.write(new Buffer(item));\n    });\n    writable.end();\n  }\n};\n"]}