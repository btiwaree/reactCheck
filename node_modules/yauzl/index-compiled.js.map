{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["var fs = require(\"fs\");\nvar zlib = require(\"zlib\");\nvar fd_slicer = require(\"fd-slicer\");\nvar util = require(\"util\");\nvar EventEmitter = require(\"events\").EventEmitter;\nvar Transform = require(\"stream\").Transform;\nvar PassThrough = require(\"stream\").PassThrough;\nvar Writable = require(\"stream\").Writable;\n\nexports.open = open;\nexports.fromFd = fromFd;\nexports.fromBuffer = fromBuffer;\nexports.fromRandomAccessReader = fromRandomAccessReader;\nexports.dosDateTimeToDate = dosDateTimeToDate;\nexports.ZipFile = ZipFile;\nexports.Entry = Entry;\nexports.RandomAccessReader = RandomAccessReader;\n\nfunction open(path, options, callback) {\n  if (typeof options === \"function\") {\n    callback = options;\n    options = null;\n  }\n  if (options == null) options = {};\n  if (options.autoClose == null) options.autoClose = true;\n  if (options.lazyEntries == null) options.lazyEntries = false;\n  if (callback == null) callback = defaultCallback;\n  fs.open(path, \"r\", function(err, fd) {\n    if (err) return callback(err);\n    fromFd(fd, options, function(err, zipfile) {\n      if (err) fs.close(fd, defaultCallback);\n      callback(err, zipfile);\n    });\n  });\n}\n\nfunction fromFd(fd, options, callback) {\n  if (typeof options === \"function\") {\n    callback = options;\n    options = null;\n  }\n  if (options == null) options = {};\n  if (options.autoClose == null) options.autoClose = false;\n  if (options.lazyEntries == null) options.lazyEntries = false;\n  if (callback == null) callback = defaultCallback;\n  fs.fstat(fd, function(err, stats) {\n    if (err) return callback(err);\n    var reader = fd_slicer.createFromFd(fd, {autoClose: true});\n    fromRandomAccessReader(reader, stats.size, options, callback);\n  });\n}\n\nfunction fromBuffer(buffer, options, callback) {\n  if (typeof options === \"function\") {\n    callback = options;\n    options = null;\n  }\n  if (options == null) options = {};\n  options.autoClose = false;\n  if (options.lazyEntries == null) options.lazyEntries = false;\n  // i got your open file right here.\n  var reader = fd_slicer.createFromBuffer(buffer);\n  fromRandomAccessReader(reader, buffer.length, options, callback);\n}\n\nfunction fromRandomAccessReader(reader, totalSize, options, callback) {\n  if (typeof options === \"function\") {\n    callback = options;\n    options = null;\n  }\n  if (options == null) options = {};\n  if (options.autoClose == null) options.autoClose = true;\n  if (options.lazyEntries == null) options.lazyEntries = false;\n  if (callback == null) callback = defaultCallback;\n  if (typeof totalSize !== \"number\") throw new Error(\"expected totalSize parameter to be a number\");\n  if (totalSize > Number.MAX_SAFE_INTEGER) {\n    throw new Error(\"zip file too large. only file sizes up to 2^52 are supported due to JavaScript's Number type being an IEEE 754 double.\");\n  }\n\n  // the matching unref() call is in zipfile.close()\n  reader.ref();\n\n  // eocdr means End of Central Directory Record.\n  // search backwards for the eocdr signature.\n  // the last field of the eocdr is a variable-length comment.\n  // the comment size is encoded in a 2-byte field in the eocdr, which we can't find without trudging backwards through the comment to find it.\n  // as a consequence of this design decision, it's possible to have ambiguous zip file metadata if a coherent eocdr was in the comment.\n  // we search backwards for a eocdr signature, and hope that whoever made the zip file was smart enough to forbid the eocdr signature in the comment.\n  var eocdrWithoutCommentSize = 22;\n  var maxCommentSize = 0x10000; // 2-byte size\n  var bufferSize = Math.min(eocdrWithoutCommentSize + maxCommentSize, totalSize);\n  var buffer = new Buffer(bufferSize);\n  var bufferReadStart = totalSize - buffer.length;\n  readAndAssertNoEof(reader, buffer, 0, bufferSize, bufferReadStart, function(err) {\n    if (err) return callback(err);\n    for (var i = bufferSize - eocdrWithoutCommentSize; i >= 0; i -= 1) {\n      if (buffer.readUInt32LE(i) !== 0x06054b50) continue;\n      // found eocdr\n      var eocdrBuffer = buffer.slice(i);\n\n      // 0 - End of central directory signature = 0x06054b50\n      // 4 - Number of this disk\n      var diskNumber = eocdrBuffer.readUInt16LE(4);\n      if (diskNumber !== 0) return callback(new Error(\"multi-disk zip files are not supported: found disk number: \" + diskNumber));\n      // 6 - Disk where central directory starts\n      // 8 - Number of central directory records on this disk\n      // 10 - Total number of central directory records\n      var entryCount = eocdrBuffer.readUInt16LE(10);\n      // 12 - Size of central directory (bytes)\n      // 16 - Offset of start of central directory, relative to start of archive\n      var centralDirectoryOffset = eocdrBuffer.readUInt32LE(16);\n      // 20 - Comment length\n      var commentLength = eocdrBuffer.readUInt16LE(20);\n      var expectedCommentLength = eocdrBuffer.length - eocdrWithoutCommentSize;\n      if (commentLength !== expectedCommentLength) {\n        return callback(new Error(\"invalid comment length. expected: \" + expectedCommentLength + \". found: \" + commentLength));\n      }\n      // 22 - Comment\n      // the encoding is always cp437.\n      var comment = bufferToString(eocdrBuffer, 22, eocdrBuffer.length, false);\n\n      if (!(entryCount === 0xffff || centralDirectoryOffset === 0xffffffff)) {\n        return callback(null, new ZipFile(reader, centralDirectoryOffset, totalSize, entryCount, comment, options.autoClose, options.lazyEntries));\n      }\n\n      // ZIP64 format\n\n      // ZIP64 Zip64 end of central directory locator\n      var zip64EocdlBuffer = new Buffer(20);\n      var zip64EocdlOffset = bufferReadStart + i - zip64EocdlBuffer.length;\n      readAndAssertNoEof(reader, zip64EocdlBuffer, 0, zip64EocdlBuffer.length, zip64EocdlOffset, function(err) {\n        if (err) return callback(err);\n\n        // 0 - zip64 end of central dir locator signature = 0x07064b50\n        if (zip64EocdlBuffer.readUInt32LE(0) !== 0x07064b50) {\n          return callback(new Error(\"invalid ZIP64 End of Central Directory Locator signature\"));\n        }\n        // 4 - number of the disk with the start of the zip64 end of central directory\n        // 8 - relative offset of the zip64 end of central directory record\n        var zip64EocdrOffset = readUInt64LE(zip64EocdlBuffer, 8);\n        // 16 - total number of disks\n\n        // ZIP64 end of central directory record\n        var zip64EocdrBuffer = new Buffer(56);\n        readAndAssertNoEof(reader, zip64EocdrBuffer, 0, zip64EocdrBuffer.length, zip64EocdrOffset, function(err) {\n          if (err) return callback(err);\n\n          // 0 - zip64 end of central dir signature                           4 bytes  (0x06064b50)\n          if (zip64EocdrBuffer.readUInt32LE(0) !== 0x06064b50) return callback(new Error(\"invalid ZIP64 end of central directory record signature\"));\n          // 4 - size of zip64 end of central directory record                8 bytes\n          // 12 - version made by                                             2 bytes\n          // 14 - version needed to extract                                   2 bytes\n          // 16 - number of this disk                                         4 bytes\n          // 20 - number of the disk with the start of the central directory  4 bytes\n          // 24 - total number of entries in the central directory on this disk         8 bytes\n          // 32 - total number of entries in the central directory            8 bytes\n          entryCount = readUInt64LE(zip64EocdrBuffer, 32);\n          // 40 - size of the central directory                               8 bytes\n          // 48 - offset of start of central directory with respect to the starting disk number     8 bytes\n          centralDirectoryOffset = readUInt64LE(zip64EocdrBuffer, 48);\n          // 56 - zip64 extensible data sector                                (variable size)\n          return callback(null, new ZipFile(reader, centralDirectoryOffset, totalSize, entryCount, comment, options.autoClose, options.lazyEntries));\n        });\n      });\n      return;\n    }\n    callback(new Error(\"end of central directory record signature not found\"));\n  });\n}\n\nutil.inherits(ZipFile, EventEmitter);\nfunction ZipFile(reader, centralDirectoryOffset, fileSize, entryCount, comment, autoClose, lazyEntries) {\n  var self = this;\n  EventEmitter.call(self);\n  self.reader = reader;\n  // forward close events\n  self.reader.on(\"error\", function(err) {\n    // error closing the fd\n    emitError(self, err);\n  });\n  self.reader.once(\"close\", function() {\n    self.emit(\"close\");\n  });\n  self.readEntryCursor = centralDirectoryOffset;\n  self.fileSize = fileSize;\n  self.entryCount = entryCount;\n  self.comment = comment;\n  self.entriesRead = 0;\n  self.autoClose = !!autoClose;\n  self.lazyEntries = !!lazyEntries;\n  self.isOpen = true;\n  self.emittedError = false;\n\n  if (!self.lazyEntries) self.readEntry();\n}\nZipFile.prototype.close = function() {\n  if (!this.isOpen) return;\n  this.isOpen = false;\n  this.reader.unref();\n};\n\nfunction emitErrorAndAutoClose(self, err) {\n  if (self.autoClose) self.close();\n  emitError(self, err);\n}\nfunction emitError(self, err) {\n  if (self.emittedError) return;\n  self.emittedError = true;\n  self.emit(\"error\", err);\n}\n\nZipFile.prototype.readEntry = function() {\n  var self = this;\n  if (self.entryCount === self.entriesRead) {\n    // done with metadata\n    setImmediate(function() {\n      if (self.autoClose) self.close();\n      if (self.emittedError) return;\n      self.emit(\"end\");\n    });\n    return;\n  }\n  if (self.emittedError) return;\n  var buffer = new Buffer(46);\n  readAndAssertNoEof(self.reader, buffer, 0, buffer.length, self.readEntryCursor, function(err) {\n    if (err) return emitErrorAndAutoClose(self, err);\n    if (self.emittedError) return;\n    var entry = new Entry();\n    // 0 - Central directory file header signature\n    var signature = buffer.readUInt32LE(0);\n    if (signature !== 0x02014b50) return emitErrorAndAutoClose(self, new Error(\"invalid central directory file header signature: 0x\" + signature.toString(16)));\n    // 4 - Version made by\n    entry.versionMadeBy = buffer.readUInt16LE(4);\n    // 6 - Version needed to extract (minimum)\n    entry.versionNeededToExtract = buffer.readUInt16LE(6);\n    // 8 - General purpose bit flag\n    entry.generalPurposeBitFlag = buffer.readUInt16LE(8);\n    // 10 - Compression method\n    entry.compressionMethod = buffer.readUInt16LE(10);\n    // 12 - File last modification time\n    entry.lastModFileTime = buffer.readUInt16LE(12);\n    // 14 - File last modification date\n    entry.lastModFileDate = buffer.readUInt16LE(14);\n    // 16 - CRC-32\n    entry.crc32 = buffer.readUInt32LE(16);\n    // 20 - Compressed size\n    entry.compressedSize = buffer.readUInt32LE(20);\n    // 24 - Uncompressed size\n    entry.uncompressedSize = buffer.readUInt32LE(24);\n    // 28 - File name length (n)\n    entry.fileNameLength = buffer.readUInt16LE(28);\n    // 30 - Extra field length (m)\n    entry.extraFieldLength = buffer.readUInt16LE(30);\n    // 32 - File comment length (k)\n    entry.fileCommentLength = buffer.readUInt16LE(32);\n    // 34 - Disk number where file starts\n    // 36 - Internal file attributes\n    entry.internalFileAttributes = buffer.readUInt16LE(36);\n    // 38 - External file attributes\n    entry.externalFileAttributes = buffer.readUInt32LE(38);\n    // 42 - Relative offset of local file header\n    entry.relativeOffsetOfLocalHeader = buffer.readUInt32LE(42);\n\n    self.readEntryCursor += 46;\n\n    buffer = new Buffer(entry.fileNameLength + entry.extraFieldLength + entry.fileCommentLength);\n    readAndAssertNoEof(self.reader, buffer, 0, buffer.length, self.readEntryCursor, function(err) {\n      if (err) return emitErrorAndAutoClose(self, err);\n      if (self.emittedError) return;\n      // 46 - File name\n      var isUtf8 = entry.generalPurposeBitFlag & 0x800\n      try {\n        entry.fileName = bufferToString(buffer, 0, entry.fileNameLength, isUtf8);\n      } catch (e) {\n        return emitErrorAndAutoClose(self, e);\n      }\n\n      // 46+n - Extra field\n      var fileCommentStart = entry.fileNameLength + entry.extraFieldLength;\n      var extraFieldBuffer = buffer.slice(entry.fileNameLength, fileCommentStart);\n      entry.extraFields = [];\n      var i = 0;\n      while (i < extraFieldBuffer.length) {\n        var headerId = extraFieldBuffer.readUInt16LE(i + 0);\n        var dataSize = extraFieldBuffer.readUInt16LE(i + 2);\n        var dataStart = i + 4;\n        var dataEnd = dataStart + dataSize;\n        var dataBuffer = new Buffer(dataSize);\n        extraFieldBuffer.copy(dataBuffer, 0, dataStart, dataEnd);\n        entry.extraFields.push({\n          id: headerId,\n          data: dataBuffer,\n        });\n        i = dataEnd;\n      }\n\n      // 46+n+m - File comment\n      try {\n        entry.fileComment = bufferToString(buffer, fileCommentStart, fileCommentStart + entry.fileCommentLength, isUtf8);\n      } catch (e) {\n        return emitErrorAndAutoClose(self, e);\n      }\n\n      self.readEntryCursor += buffer.length;\n      self.entriesRead += 1;\n\n      if (entry.uncompressedSize            === 0xffffffff ||\n          entry.compressedSize              === 0xffffffff ||\n          entry.relativeOffsetOfLocalHeader === 0xffffffff) {\n        // ZIP64 format\n        // find the Zip64 Extended Information Extra Field\n        var zip64EiefBuffer = null;\n        for (var i = 0; i < entry.extraFields.length; i++) {\n          var extraField = entry.extraFields[i];\n          if (extraField.id === 0x0001) {\n            zip64EiefBuffer = extraField.data;\n            break;\n          }\n        }\n        if (zip64EiefBuffer == null) return emitErrorAndAutoClose(self, new Error(\"expected Zip64 Extended Information Extra Field\"));\n        var index = 0;\n        // 0 - Original Size          8 bytes\n        if (entry.uncompressedSize === 0xffffffff) {\n          if (index + 8 > zip64EiefBuffer.length) return emitErrorAndAutoClose(self, new Error(\"Zip64 Extended Information Extra Field does not include Original Size\"));\n          entry.uncompressedSize = readUInt64LE(zip64EiefBuffer, index);\n          index += 8;\n        }\n        // 8 - Compressed Size        8 bytes\n        if (entry.compressedSize === 0xffffffff) {\n          if (index + 8 > zip64EiefBuffer.length) return emitErrorAndAutoClose(self, new Error(\"Zip64 Extended Information Extra Field does not include Compressed Size\"));\n          entry.compressedSize = readUInt64LE(zip64EiefBuffer, index);\n          index += 8;\n        }\n        // 16 - Relative Header Offset 8 bytes\n        if (entry.relativeOffsetOfLocalHeader === 0xffffffff) {\n          if (index + 8 > zip64EiefBuffer.length) return emitErrorAndAutoClose(self, new Error(\"Zip64 Extended Information Extra Field does not include Relative Header Offset\"));\n          entry.relativeOffsetOfLocalHeader = readUInt64LE(zip64EiefBuffer, index);\n          index += 8;\n        }\n        // 24 - Disk Start Number      4 bytes\n      }\n\n      // validate file size\n      if (entry.compressionMethod === 0) {\n        if (entry.compressedSize !== entry.uncompressedSize) {\n          var msg = \"compressed/uncompressed size mismatch for stored file: \" + entry.compressedSize + \" != \" + entry.uncompressedSize;\n          return emitErrorAndAutoClose(self, new Error(msg));\n        }\n      }\n\n      // validate file name\n      if (entry.fileName.indexOf(\"\\\\\") !== -1) return emitErrorAndAutoClose(self, new Error(\"invalid characters in fileName: \" + entry.fileName));\n      if (/^[a-zA-Z]:/.test(entry.fileName) || /^\\//.test(entry.fileName)) return emitErrorAndAutoClose(self, new Error(\"absolute path: \" + entry.fileName));\n      if (entry.fileName.split(\"/\").indexOf(\"..\") !== -1) return emitErrorAndAutoClose(self, new Error(\"invalid relative path: \" + entry.fileName));\n      self.emit(\"entry\", entry);\n\n      if (!self.lazyEntries) self.readEntry();\n    });\n  });\n};\n\nZipFile.prototype.openReadStream = function(entry, callback) {\n  var self = this;\n  if (!self.isOpen) return callback(new Error(\"closed\"));\n  // make sure we don't lose the fd before we open the actual read stream\n  self.reader.ref();\n  var buffer = new Buffer(30);\n  readAndAssertNoEof(self.reader, buffer, 0, buffer.length, entry.relativeOffsetOfLocalHeader, function(err) {\n    try {\n      if (err) return callback(err);\n      // 0 - Local file header signature = 0x04034b50\n      var signature = buffer.readUInt32LE(0);\n      if (signature !== 0x04034b50) return callback(new Error(\"invalid local file header signature: 0x\" + signature.toString(16)));\n      // all this should be redundant\n      // 4 - Version needed to extract (minimum)\n      // 6 - General purpose bit flag\n      // 8 - Compression method\n      // 10 - File last modification time\n      // 12 - File last modification date\n      // 14 - CRC-32\n      // 18 - Compressed size\n      // 22 - Uncompressed size\n      // 26 - File name length (n)\n      var fileNameLength = buffer.readUInt16LE(26);\n      // 28 - Extra field length (m)\n      var extraFieldLength = buffer.readUInt16LE(28);\n      // 30 - File name\n      // 30+n - Extra field\n      var localFileHeaderEnd = entry.relativeOffsetOfLocalHeader + buffer.length + fileNameLength + extraFieldLength;\n      var compressed;\n      if (entry.compressionMethod === 0) {\n        // 0 - The file is stored (no compression)\n        compressed = false;\n      } else if (entry.compressionMethod === 8) {\n        // 8 - The file is Deflated\n        compressed = true;\n      } else {\n        return callback(new Error(\"unsupported compression method: \" + entry.compressionMethod));\n      }\n      var fileDataStart = localFileHeaderEnd;\n      var fileDataEnd = fileDataStart + entry.compressedSize;\n      if (entry.compressedSize !== 0) {\n        // bounds check now, because the read streams will probably not complain loud enough.\n        // since we're dealing with an unsigned offset plus an unsigned size,\n        // we only have 1 thing to check for.\n        if (fileDataEnd > self.fileSize) {\n          return callback(new Error(\"file data overflows file bounds: \" +\n              fileDataStart + \" + \" + entry.compressedSize + \" > \" + self.fileSize));\n        }\n      }\n      var readStream = self.reader.createReadStream({start: fileDataStart, end: fileDataEnd});\n      var endpointStream = readStream;\n      if (compressed) {\n        var destroyed = false;\n        var inflateFilter = zlib.createInflateRaw();\n        readStream.on(\"error\", function(err) {\n          // setImmediate here because errors can be emitted during the first call to pipe()\n          setImmediate(function() {\n            if (!destroyed) inflateFilter.emit(\"error\", err);\n          });\n        });\n\n        var checkerStream = new AssertByteCountStream(entry.uncompressedSize);\n        inflateFilter.on(\"error\", function(err) {\n          // forward zlib errors to the client-visible stream\n          setImmediate(function() {\n            if (!destroyed) checkerStream.emit(\"error\", err);\n          });\n        });\n        checkerStream.destroy = function() {\n          destroyed = true;\n          inflateFilter.unpipe(checkerStream);\n          readStream.unpipe(inflateFilter);\n          // TODO: the inflateFilter now causes a memory leak. see Issue #27.\n          readStream.destroy();\n        };\n        endpointStream = readStream.pipe(inflateFilter).pipe(checkerStream);\n      }\n      callback(null, endpointStream);\n    } finally {\n      self.reader.unref();\n    }\n  });\n};\n\nfunction Entry() {\n}\nEntry.prototype.getLastModDate = function() {\n  return dosDateTimeToDate(this.lastModFileDate, this.lastModFileTime);\n};\n\nfunction dosDateTimeToDate(date, time) {\n  var day = date & 0x1f; // 1-31\n  var month = (date >> 5 & 0xf) - 1; // 1-12, 0-11\n  var year = (date >> 9 & 0x7f) + 1980; // 0-128, 1980-2108\n\n  var millisecond = 0;\n  var second = (time & 0x1f) * 2; // 0-29, 0-58 (even numbers)\n  var minute = time >> 5 & 0x3f; // 0-59\n  var hour = time >> 11 & 0x1f; // 0-23\n\n  return new Date(year, month, day, hour, minute, second, millisecond);\n}\n\nfunction readAndAssertNoEof(reader, buffer, offset, length, position, callback) {\n  if (length === 0) {\n    // fs.read will throw an out-of-bounds error if you try to read 0 bytes from a 0 byte file\n    return setImmediate(function() { callback(null, new Buffer(0)); });\n  }\n  reader.read(buffer, offset, length, position, function(err, bytesRead) {\n    if (err) return callback(err);\n    if (bytesRead < length) return callback(new Error(\"unexpected EOF\"));\n    callback();\n  });\n}\n\nutil.inherits(AssertByteCountStream, Transform);\nfunction AssertByteCountStream(byteCount) {\n  Transform.call(this);\n  this.actualByteCount = 0;\n  this.expectedByteCount = byteCount;\n}\nAssertByteCountStream.prototype._transform = function(chunk, encoding, cb) {\n  this.actualByteCount += chunk.length;\n  if (this.actualByteCount > this.expectedByteCount) {\n    var msg = \"too many bytes in the stream. expected \" + this.expectedByteCount + \". got at least \" + this.actualByteCount;\n    return cb(new Error(msg));\n  }\n  cb(null, chunk);\n};\nAssertByteCountStream.prototype._flush = function(cb) {\n  if (this.actualByteCount < this.expectedByteCount) {\n    var msg = \"not enough bytes in the stream. expected \" + this.expectedByteCount + \". got only \" + this.actualByteCount;\n    return cb(new Error(msg));\n  }\n  cb();\n};\n\nutil.inherits(RandomAccessReader, EventEmitter);\nfunction RandomAccessReader() {\n  EventEmitter.call(this);\n  this.refCount = 0;\n}\nRandomAccessReader.prototype.ref = function() {\n  this.refCount += 1;\n};\nRandomAccessReader.prototype.unref = function() {\n  var self = this;\n  self.refCount -= 1;\n\n  if (self.refCount > 0) return;\n  if (self.refCount < 0) throw new Error(\"invalid unref\");\n\n  self.close(onCloseDone);\n\n  function onCloseDone(err) {\n    if (err) return self.emit('error', err);\n    self.emit('close');\n  }\n};\nRandomAccessReader.prototype.createReadStream = function(options) {\n  var start = options.start;\n  var end = options.end;\n  if (start === end) {\n    var emptyStream = new PassThrough();\n    setImmediate(function() {\n      emptyStream.end();\n    });\n    return emptyStream;\n  }\n  var stream = this._readStreamForRange(start, end);\n\n  var destroyed = false;\n  var refUnrefFilter = new RefUnrefFilter(this);\n  stream.on(\"error\", function(err) {\n    setImmediate(function() {\n      if (!destroyed) refUnrefFilter.emit(\"error\", err);\n    });\n  });\n  refUnrefFilter.destroy = function() {\n    stream.unpipe(refUnrefFilter);\n    refUnrefFilter.unref();\n    stream.destroy();\n  };\n\n  var byteCounter = new AssertByteCountStream(end - start);\n  refUnrefFilter.on(\"error\", function(err) {\n    setImmediate(function() {\n      if (!destroyed) byteCounter.emit(\"error\", err);\n    });\n  });\n  byteCounter.destroy = function() {\n    destroyed = true;\n    refUnrefFilter.unpipe(byteCounter);\n    refUnrefFilter.destroy();\n  };\n\n  return stream.pipe(refUnrefFilter).pipe(byteCounter);\n};\nRandomAccessReader.prototype._readStreamForRange = function(start, end) {\n  throw new Error(\"not implemented\");\n};\nRandomAccessReader.prototype.read = function(buffer, offset, length, position, callback) {\n  var readStream = this.createReadStream({start: position, end: position + length});\n  var writeStream = new Writable();\n  var written = 0;\n  writeStream._write = function(chunk, encoding, cb) {\n    chunk.copy(buffer, offset + written, 0, chunk.length);\n    written += chunk.length;\n    cb();\n  };\n  writeStream.on(\"finish\", callback);\n  readStream.on(\"error\", function(error) {\n    callback(error);\n  });\n  readStream.pipe(writeStream);\n};\nRandomAccessReader.prototype.close = function(callback) {\n  setImmediate(callback);\n};\n\nutil.inherits(RefUnrefFilter, PassThrough);\nfunction RefUnrefFilter(context) {\n  PassThrough.call(this);\n  this.context = context;\n  this.context.ref();\n  this.unreffedYet = false;\n}\nRefUnrefFilter.prototype._flush = function(cb) {\n  this.unref();\n  cb();\n};\nRefUnrefFilter.prototype.unref = function(cb) {\n  if (this.unreffedYet) return;\n  this.unreffedYet = true;\n  this.context.unref();\n};\n\nvar cp437 = '\\u0000☺☻♥♦♣♠•◘○◙♂♀♪♫☼►◄↕‼¶§▬↨↑↓→←∟↔▲▼ !\"#$%&\\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~⌂ÇüéâäàåçêëèïîìÄÅÉæÆôöòûùÿÖÜ¢£¥₧ƒáíóúñÑªº¿⌐¬½¼¡«»░▒▓│┤╡╢╖╕╣║╗╝╜╛┐└┴┬├─┼╞╟╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌█▄▌▐▀αßΓπΣσµτΦΘΩδ∞φε∩≡±≥≤⌠⌡÷≈°∙·√ⁿ²■ ';\nfunction bufferToString(buffer, start, end, isUtf8) {\n  if (isUtf8) {\n    return buffer.toString(\"utf8\", start, end);\n  } else {\n    var result = \"\";\n    for (var i = start; i < end; i++) {\n      result += cp437[buffer[i]];\n    }\n    return result;\n  }\n}\n\nfunction readUInt64LE(buffer, offset) {\n  // there is no native function for this, because we can't actually store 64-bit integers precisely.\n  // after 53 bits, JavaScript's Number type (IEEE 754 double) can't store individual integers anymore.\n  // but since 53 bits is a whole lot more than 32 bits, we do our best anyway.\n  var lower32 = buffer.readUInt32LE(offset);\n  var upper32 = buffer.readUInt32LE(offset + 4);\n  // we can't use bitshifting here, because JavaScript bitshifting only works on 32-bit integers.\n  return upper32 * 0x100000000 + lower32;\n  // as long as we're bounds checking the result of this function against the total file size,\n  // we'll catch any overflow errors, because we already made sure the total file size was within reason.\n}\n\nfunction defaultCallback(err) {\n  if (err) throw err;\n}\n"]}