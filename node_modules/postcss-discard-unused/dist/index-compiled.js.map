{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _uniqs = require('uniqs');\n\nvar _uniqs2 = _interopRequireDefault(_uniqs);\n\nvar _postcss = require('postcss');\n\nvar _postcss2 = _interopRequireDefault(_postcss);\n\nvar _flatten = require('flatten');\n\nvar _flatten2 = _interopRequireDefault(_flatten);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar comma = _postcss.list.comma;\nvar space = _postcss.list.space;\n\nfunction filterAtRule(css, declRegex, atruleRegex) {\n    var atRules = [];\n    var values = [];\n    css.walk(function (node) {\n        if (node.type === 'decl' && declRegex.test(node.prop)) {\n            return comma(node.value).forEach(function (val) {\n                return values.push(space(val));\n            });\n        }\n        if (node.type === 'atrule' && atruleRegex.test(node.name)) {\n            atRules.push(node);\n        }\n    });\n    values = (0, _uniqs2.default)((0, _flatten2.default)(values));\n    atRules.forEach(function (node) {\n        var hasAtRule = values.some(function (value) {\n            return value === node.params;\n        });\n        if (!hasAtRule) {\n            node.remove();\n        }\n    });\n}\n\nfunction hasFont(fontFamily, cache) {\n    return comma(fontFamily).some(function (font) {\n        return cache.some(function (c) {\n            return ~c.indexOf(font);\n        });\n    });\n}\n\nfunction filterNamespace(css) {\n    var atRules = [];\n    var rules = [];\n    css.walk(function (node) {\n        var type = node.type;\n        var selector = node.selector;\n        var name = node.name;\n\n        if (type === 'rule' && /\\|/.test(selector)) {\n            return rules.push(selector.split('|')[0]);\n        }\n        if (type === 'atrule' && name === 'namespace') {\n            atRules.push(node);\n        }\n    });\n    rules = (0, _uniqs2.default)((0, _flatten2.default)(rules));\n    atRules.forEach(function (atRule) {\n        var _atRule$params$split$ = atRule.params.split(' ').filter(Boolean);\n\n        var param = _atRule$params$split$[0];\n        var len = _atRule$params$split$.length;\n\n        if (len === 1) {\n            return;\n        }\n        var hasRule = rules.some(function (rule) {\n            return rule === param || rule === '*';\n        });\n        if (!hasRule) {\n            atRule.remove();\n        }\n    });\n}\n\n// fonts have slightly different logic\nfunction filterFont(css) {\n    var atRules = [];\n    var values = [];\n    css.walk(function (node) {\n        if (node.type === 'decl' && node.parent.type === 'rule' && /font(|-family)/.test(node.prop)) {\n            return values.push(comma(node.value));\n        }\n        if (node.type === 'atrule' && node.name === 'font-face' && node.nodes) {\n            atRules.push(node);\n        }\n    });\n    values = (0, _uniqs2.default)((0, _flatten2.default)(values));\n    atRules.forEach(function (rule) {\n        var families = rule.nodes.filter(function (node) {\n            return node.prop === 'font-family';\n        });\n        // Discard the @font-face if it has no font-family\n        if (!families.length) {\n            return rule.remove();\n        }\n        families.forEach(function (family) {\n            if (!hasFont(family.value, values)) {\n                rule.remove();\n            }\n        });\n    });\n}\n\nmodule.exports = _postcss2.default.plugin('postcss-discard-unused', function (opts) {\n    var _fontFace$counterStyl = _extends({\n        fontFace: true,\n        counterStyle: true,\n        keyframes: true,\n        namespace: true\n    }, opts);\n\n    var fontFace = _fontFace$counterStyl.fontFace;\n    var counterStyle = _fontFace$counterStyl.counterStyle;\n    var keyframes = _fontFace$counterStyl.keyframes;\n    var namespace = _fontFace$counterStyl.namespace;\n\n    return function (css) {\n        if (fontFace) {\n            filterFont(css);\n        }\n        if (counterStyle) {\n            filterAtRule(css, /list-style|system/, /counter-style/);\n        }\n        if (keyframes) {\n            filterAtRule(css, /animation/, /keyframes/);\n        }\n        if (namespace) {\n            filterNamespace(css);\n        }\n    };\n});"]}