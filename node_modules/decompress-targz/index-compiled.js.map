{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,OAAO,QAAQ,OAAR,CAAP;AACJ,IAAI,KAAK,QAAQ,IAAR,CAAL;AACJ,IAAI,SAAS,QAAQ,SAAR,CAAT;AACJ,IAAI,eAAe,QAAQ,eAAR,CAAf;AACJ,IAAI,YAAY,QAAQ,YAAR,CAAZ;AACJ,IAAI,MAAM,QAAQ,YAAR,CAAN;AACJ,IAAI,UAAU,QAAQ,UAAR,CAAV;AACJ,IAAI,OAAO,QAAQ,MAAR,CAAP;;AAEJ,OAAO,OAAP,GAAiB,UAAU,IAAV,EAAgB;AAChC,QAAO,QAAQ,EAAR,CADyB;AAEhC,MAAK,KAAL,GAAa,CAAC,KAAK,KAAL,IAAc,CAAf,CAFmB;;AAIhC,QAAO,QAAQ,GAAR,CAAY,UAAU,IAAV,EAAgB,GAAhB,EAAqB,EAArB,EAAyB;AAC3C,MAAI,OAAO,IAAP,CADuC;AAE3C,MAAI,UAAU,IAAI,OAAJ,EAAV,CAFuC;AAG3C,MAAI,QAAQ,KAAK,KAAL,EAAR,CAHuC;;AAK3C,MAAI,KAAK,MAAL,EAAJ,EAAmB;AAClB,MAAG,IAAH,EAAS,IAAT,EADkB;AAElB,UAFkB;GAAnB;;AAKA,MAAI,KAAK,QAAL,EAAJ,EAAqB;AACpB,MAAG,IAAI,KAAJ,CAAU,4BAAV,CAAH,EADoB;AAEpB,UAFoB;GAArB;;AAKA,MAAI,CAAC,KAAK,OAAL,IAAgB,CAAC,OAAO,KAAK,QAAL,CAAR,EAAwB;AAC5C,MAAG,IAAH,EAAS,IAAT,EAD4C;AAE5C,UAF4C;GAA7C;;AAKA,UAAQ,EAAR,CAAW,OAAX,EAAoB,UAAU,MAAV,EAAkB,MAAlB,EAA0B,IAA1B,EAAgC;AACnD,OAAI,QAAQ,EAAR,CAD+C;AAEnD,OAAI,MAAM,CAAN,CAF+C;;AAInD,UAAO,EAAP,CAAU,MAAV,EAAkB,UAAU,IAAV,EAAgB;AACjC,UAAM,IAAN,CAAW,IAAX,EADiC;AAEjC,WAAO,KAAK,MAAL,CAF0B;IAAhB,CAAlB,CAJmD;;AASnD,UAAO,EAAP,CAAU,KAAV,EAAiB,YAAY;AAC5B,QAAI,OAAO,IAAP,KAAgB,WAAhB,EAA6B;AAChC,UAAK,IAAL,CAAU,IAAI,IAAJ,CAAS;AAClB,gBAAU,OAAO,MAAP,CAAc,KAAd,EAAqB,GAArB,CAAV;AACA,YAAM,UAAU,OAAO,IAAP,EAAa,KAAK,KAAL,CAA7B;AACA,YAAM,aAAa,IAAI,GAAG,KAAH,EAAjB,EAA6B,MAA7B,CAAN;MAHS,CAAV,EADgC;KAAjC;;AAQA,WAT4B;IAAZ,CAAjB,CATmD;GAAhC,CAApB,CApB2C;;AA0C3C,UAAQ,EAAR,CAAW,QAAX,EAAqB,EAArB,EA1C2C;AA2C3C,UAAQ,EAAR,CAAW,OAAX,EAAoB,EAApB,EA3C2C;AA4C3C,QAAM,GAAN,CAAU,KAAK,QAAL,CAAV,CA5C2C;AA6C3C,QAAM,IAAN,CAAW,OAAX,EA7C2C;EAAzB,CAAnB,CAJgC;CAAhB","file":"index-compiled.js","sourcesContent":["'use strict';\n\nvar File = require('vinyl');\nvar fs = require('fs');\nvar isGzip = require('is-gzip');\nvar objectAssign = require('object-assign');\nvar stripDirs = require('strip-dirs');\nvar tar = require('tar-stream');\nvar through = require('through2');\nvar zlib = require('zlib');\n\nmodule.exports = function (opts) {\n\topts = opts || {};\n\topts.strip = +opts.strip || 0;\n\n\treturn through.obj(function (file, enc, cb) {\n\t\tvar self = this;\n\t\tvar extract = tar.extract();\n\t\tvar unzip = zlib.Unzip();\n\n\t\tif (file.isNull()) {\n\t\t\tcb(null, file);\n\t\t\treturn;\n\t\t}\n\n\t\tif (file.isStream()) {\n\t\t\tcb(new Error('Streaming is not supported'));\n\t\t\treturn;\n\t\t}\n\n\t\tif (!file.extract || !isGzip(file.contents)) {\n\t\t\tcb(null, file);\n\t\t\treturn;\n\t\t}\n\n\t\textract.on('entry', function (header, stream, done) {\n\t\t\tvar chunk = [];\n\t\t\tvar len = 0;\n\n\t\t\tstream.on('data', function (data) {\n\t\t\t\tchunk.push(data);\n\t\t\t\tlen += data.length;\n\t\t\t});\n\n\t\t\tstream.on('end', function () {\n\t\t\t\tif (header.type !== 'directory') {\n\t\t\t\t\tself.push(new File({\n\t\t\t\t\t\tcontents: Buffer.concat(chunk, len),\n\t\t\t\t\t\tpath: stripDirs(header.name, opts.strip),\n\t\t\t\t\t\tstat: objectAssign(new fs.Stats(), header)\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\textract.on('finish', cb);\n\t\textract.on('error', cb);\n\t\tunzip.end(file.contents);\n\t\tunzip.pipe(extract);\n\t});\n};\n"]}