{"version":3,"sources":["translateWithSourceMap.js"],"names":[],"mappings":"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","file":"translateWithSourceMap-compiled.js","sourcesContent":["var SourceMapGenerator = require('source-map').SourceMapGenerator;\nvar SourceNode = require('source-map').SourceNode;\n\n// Our own implementation of SourceNode#toStringWithSourceMap,\n// since SourceNode doesn't allow multiple references to original source.\n// Also, as we know structure of result we could be optimize generation\n// (currently it's ~40% faster).\nfunction walk(node, fn) {\n    for (var chunk, i = 0; i < node.children.length; i++) {\n        chunk = node.children[i];\n\n        if (chunk instanceof SourceNode) {\n            // this is a hack, because source maps doesn't support for 1(generated):N(original)\n            // if (chunk.merged) {\n            //     fn('', chunk);\n            // }\n\n            walk(chunk, fn);\n        } else {\n            fn(chunk, node);\n        }\n    }\n}\n\nfunction generateSourceMap(root) {\n    var map = new SourceMapGenerator();\n    var css = '';\n    var sourceMappingActive = false;\n    var lastOriginalLine = null;\n    var lastOriginalColumn = null;\n    var lastIndexOfNewline;\n    var generated = {\n        line: 1,\n        column: 0\n    };\n    var activatedMapping = {\n        generated: generated\n    };\n\n    walk(root, function(chunk, original) {\n        if (original.line !== null &&\n            original.column !== null) {\n            if (lastOriginalLine !== original.line ||\n                lastOriginalColumn !== original.column) {\n                map.addMapping({\n                    source: original.source,\n                    original: original,\n                    generated: generated\n                });\n            }\n\n            lastOriginalLine = original.line;\n            lastOriginalColumn = original.column;\n            sourceMappingActive = true;\n        } else if (sourceMappingActive) {\n            map.addMapping(activatedMapping);\n            sourceMappingActive = false;\n        }\n\n        css += chunk;\n\n        lastIndexOfNewline = chunk.lastIndexOf('\\n');\n        if (lastIndexOfNewline !== -1) {\n            generated.line += chunk.match(/\\n/g).length;\n            generated.column = chunk.length - lastIndexOfNewline - 1;\n        } else {\n            generated.column += chunk.length;\n        }\n    });\n\n    return {\n        css: css,\n        map: map\n    };\n};\n\nfunction each(list) {\n    if (list.head === null) {\n        return '';\n    }\n\n    if (list.head === list.tail) {\n        return translate(list.head.data);\n    }\n\n    return list.map(translate).join('');\n}\n\nfunction eachDelim(list, delimeter) {\n    if (list.head === null) {\n        return '';\n    }\n\n    if (list.head === list.tail) {\n        return translate(list.head.data);\n    }\n\n    return list.map(translate).join(delimeter);\n}\n\nfunction createAnonymousSourceNode(children) {\n    return new SourceNode(\n        null,\n        null,\n        null,\n        children\n    );\n}\n\nfunction createSourceNode(info, children) {\n    if (info.primary) {\n        // special marker node to add several references to original\n        // var merged = createSourceNode(info.merged, []);\n        // merged.merged = true;\n        // children.unshift(merged);\n\n        // use recursion, because primary can also has a primary/merged info\n        return createSourceNode(info.primary, children);\n    }\n\n    return new SourceNode(\n        info.line,\n        info.column - 1,\n        info.source,\n        children\n    );\n}\n\nfunction translate(node) {\n    switch (node.type) {\n        case 'StyleSheet':\n            return createAnonymousSourceNode(node.rules.map(translate));\n\n        case 'Atrule':\n            var nodes = ['@', node.name];\n\n            if (node.expression && !node.expression.sequence.isEmpty()) {\n                nodes.push(' ', translate(node.expression));\n            }\n\n            if (node.block) {\n                nodes.push('{', translate(node.block), '}');\n            } else {\n                nodes.push(';');\n            }\n\n            return createSourceNode(node.info, nodes);\n\n        case 'Ruleset':\n            return createAnonymousSourceNode([\n                translate(node.selector), '{', translate(node.block), '}'\n            ]);\n\n        case 'Selector':\n            return createAnonymousSourceNode(node.selectors.map(translate)).join(',');\n\n        case 'SimpleSelector':\n            return createSourceNode(node.info, node.sequence.map(function(node) {\n                // add extra spaces around /deep/ combinator since comment beginning/ending may to be produced\n                if (node.type === 'Combinator' && node.name === '/deep/') {\n                    return ' ' + translate(node) + ' ';\n                }\n\n                return translate(node);\n            }));\n\n        case 'Block':\n            return createAnonymousSourceNode(node.declarations.map(translate)).join(';');\n\n        case 'Declaration':\n            return createSourceNode(\n                node.info,\n                [translate(node.property), ':', translate(node.value)]\n            );\n\n        case 'Value':\n            return node.important\n                ? each(node.sequence) + '!important'\n                : each(node.sequence);\n\n        case 'Attribute':\n            var result = translate(node.name);\n\n            if (node.operator !== null) {\n                result += node.operator;\n\n                if (node.value !== null) {\n                    result += translate(node.value);\n\n                    if (node.flags !== null) {\n                        result += (node.value.type !== 'String' ? ' ' : '') + node.flags;\n                    }\n                }\n            }\n\n            return '[' + result + ']';\n\n        case 'FunctionalPseudo':\n            return ':' + node.name + '(' + eachDelim(node.arguments, ',') + ')';\n\n        case 'Function':\n            return node.name + '(' + eachDelim(node.arguments, ',') + ')';\n\n        case 'Negation':\n            return ':not(' + eachDelim(node.sequence, ',') + ')';\n\n        case 'Braces':\n            return node.open + each(node.sequence) + node.close;\n\n        case 'Argument':\n        case 'AtruleExpression':\n            return each(node.sequence);\n\n        case 'Url':\n            return 'url(' + translate(node.value) + ')';\n\n        case 'Progid':\n            return translate(node.value);\n\n        case 'Property':\n            return node.name;\n\n        case 'Combinator':\n            return node.name;\n\n        case 'Identifier':\n            return node.name;\n\n        case 'PseudoClass':\n            return ':' + node.name;\n\n        case 'PseudoElement':\n            return '::' + node.name;\n\n        case 'Class':\n            return '.' + node.name;\n\n        case 'Id':\n            return '#' + node.name;\n\n        case 'Hash':\n            return '#' + node.value;\n\n        case 'Dimension':\n            return node.value + node.unit;\n\n        case 'Nth':\n            return node.value;\n\n        case 'Number':\n            return node.value;\n\n        case 'String':\n            return node.value;\n\n        case 'Operator':\n            return node.value;\n\n        case 'Raw':\n            return node.value;\n\n        case 'Percentage':\n            return node.value + '%';\n\n        case 'Space':\n            return ' ';\n\n        case 'Comment':\n            return '/*' + node.value + '*/';\n\n        default:\n            throw new Error('Unknown node type: ' + node.type);\n    }\n}\n\nmodule.exports = function(node) {\n    return generateSourceMap(\n        createAnonymousSourceNode(translate(node))\n    );\n};\n\n"]}