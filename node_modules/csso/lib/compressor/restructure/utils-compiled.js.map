{"version":3,"sources":["utils.js"],"names":[],"mappings":"AAAA,IAAI,iBAAiB,OAAO,SAAP,CAAiB,cAAjB;;AAErB,SAAS,YAAT,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B;AACxB,QAAI,UAAU,EAAE,IAAF,CADU;AAExB,QAAI,UAAU,EAAE,IAAF,CAFU;;AAIxB,WAAO,WAAW,OAAX,IAAsB,QAAQ,IAAR,CAAa,EAAb,KAAoB,QAAQ,IAAR,CAAa,EAAb,EAAiB;AAC9D,kBAAU,QAAQ,IAAR,CADoD;AAE9D,kBAAU,QAAQ,IAAR,CAFoD;KAAlE;;AAKA,WAAO,YAAY,IAAZ,IAAoB,YAAY,IAAZ,CATH;CAA5B;;AAYA,SAAS,mBAAT,CAA6B,CAA7B,EAAgC,CAAhC,EAAmC;AAC/B,QAAI,UAAU,EAAE,IAAF,CADiB;AAE/B,QAAI,UAAU,EAAE,IAAF,CAFiB;;AAI/B,WAAO,WAAW,OAAX,IAAsB,QAAQ,IAAR,CAAa,EAAb,KAAoB,QAAQ,IAAR,CAAa,EAAb,EAAiB;AAC9D,kBAAU,QAAQ,IAAR,CADoD;AAE9D,kBAAU,QAAQ,IAAR,CAFoD;KAAlE;;AAKA,WAAO,YAAY,IAAZ,IAAoB,YAAY,IAAZ,CATI;CAAnC;;AAYA,SAAS,mBAAT,CAA6B,aAA7B,EAA4C,aAA5C,EAA2D;AACvD,QAAI,SAAS;AACT,YAAI,EAAJ;AACA,aAAK,EAAL;AACA,aAAK,EAAL;AACA,sBAAc,EAAd;KAJA,CADmD;;AAQvD,QAAI,eAAe,OAAO,MAAP,CAAc,IAAd,CAAf,CARmD;AASvD,QAAI,oBAAoB,OAAO,MAAP,CAAc,IAAd,CAApB,CATmD;;AAWvD,SAAK,IAAI,SAAS,cAAc,IAAd,EAAoB,MAAtC,EAA8C,SAAS,OAAO,IAAP,EAAc;AACjE,0BAAkB,OAAO,IAAP,CAAY,EAAZ,CAAlB,GAAoC,IAApC,CADiE;KAArE;;AAIA,SAAK,IAAI,SAAS,cAAc,IAAd,EAAoB,MAAtC,EAA8C,SAAS,OAAO,IAAP,EAAc;AACjE,YAAI,OAAO,OAAO,IAAP,CADsD;;AAGjE,YAAI,KAAK,WAAL,EAAkB;AAClB,yBAAa,KAAK,WAAL,CAAb,GAAiC,KAAK,KAAL,CAAW,SAAX,CADf;SAAtB;;AAIA,YAAI,kBAAkB,KAAK,EAAL,CAAtB,EAAgC;AAC5B,8BAAkB,KAAK,EAAL,CAAlB,GAA6B,KAA7B,CAD4B;AAE5B,mBAAO,EAAP,CAAU,IAAV,CAAe,IAAf,EAF4B;SAAhC,MAGO;AACH,mBAAO,GAAP,CAAW,IAAX,CAAgB,IAAhB,EADG;SAHP;KAPJ;;AAeA,SAAK,IAAI,SAAS,cAAc,IAAd,EAAoB,MAAtC,EAA8C,SAAS,OAAO,IAAP,EAAc;AACjE,YAAI,OAAO,OAAO,IAAP,CADsD;;AAGjE,YAAI,kBAAkB,KAAK,EAAL,CAAtB,EAAgC;;;AAG5B,gBAAI,eAAe,IAAf,CAAoB,YAApB,EAAkC,KAAK,WAAL,CAAlC,IACA,OAAO,aAAa,KAAK,WAAL,CAApB,KAA0C,OAAO,KAAK,KAAL,CAAW,SAAX,CAAjD,EAAwE;AACxE,uBAAO,YAAP,CAAoB,IAApB,CAAyB,IAAzB,EADwE;aAD5E,MAGO;AACH,uBAAO,GAAP,CAAW,IAAX,CAAgB,IAAhB,EADG;aAHP;SAHJ;KAHJ;;AAeA,WAAO,MAAP,CA7CuD;CAA3D;;AAgDA,SAAS,YAAT,CAAsB,IAAtB,EAA4B,MAA5B,EAAoC;AAChC,WAAO,IAAP,CAAY,UAAS,UAAT,EAAqB;AAC7B,YAAI,SAAS,WAAW,EAAX,CADgB;AAE7B,YAAI,SAAS,KAAK,IAAL,CAFgB;;AAI7B,eAAO,MAAP,EAAe;AACX,gBAAI,UAAU,OAAO,IAAP,CAAY,EAAZ,CADH;;AAGX,gBAAI,YAAY,MAAZ,EAAoB;AACpB,uBADoB;aAAxB;;AAIA,gBAAI,UAAU,MAAV,EAAkB;AAClB,sBADkB;aAAtB;;AAIA,qBAAS,OAAO,IAAP,CAXE;SAAf;;AAcA,aAAK,MAAL,CAAY,KAAK,UAAL,CAAgB,UAAhB,CAAZ,EAAyC,MAAzC,EAlB6B;KAArB,CAAZ,CADgC;;AAsBhC,WAAO,IAAP,CAtBgC;CAApC;;;AA0BA,SAAS,mBAAT,CAA6B,UAA7B,EAAyC,UAAzC,EAAqD;AACjD,WAAO,WAAW,IAAX,CAAgB,UAAS,CAAT,EAAY;AAC/B,eAAO,WAAW,IAAX,CAAgB,UAAS,CAAT,EAAY;AAC/B,mBAAO,EAAE,aAAF,KAAoB,EAAE,aAAF,CADI;SAAZ,CAAvB,CAD+B;KAAZ,CAAvB,CADiD;CAArD;;;AASA,SAAS,gBAAT,CAA0B,IAA1B,EAAgC;AAC5B,YAAQ,KAAK,IAAL;AACJ,aAAK,SAAL;;AAEI,mBAAO,oBAAoB,KAAK,QAAL,CAAc,SAAd,EAAyB,IAA7C,CAAP,CAFJ;;AADJ,aAKS,QAAL;;AAEI,gBAAI,KAAK,KAAL,EAAY;;AAEZ,oBAAI,KAAK,KAAL,CAAW,IAAX,KAAoB,YAApB,EAAkC;AAClC,2BAAO,KAAP,CADkC;iBAAtC;;;AAFY,uBAOL,KAAK,KAAL,CAAW,KAAX,CAAiB,IAAjB,CAAsB,gBAAtB,EAAwC,IAAxC,CAAP,CAPY;aAAhB;AASA,kBAXJ;AALJ;;;AAD4B,WAqBrB,IAAP,CArB4B;CAAhC;;AAwBA,OAAO,OAAP,GAAiB;AACb,kBAAc,YAAd;AACA,yBAAqB,mBAArB;AACA,yBAAqB,mBAArB;AACA,kBAAc,YAAd;AACA,yBAAqB,mBAArB;AACA,sBAAkB,gBAAlB;CANJ","file":"utils-compiled.js","sourcesContent":["var hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction isEqualLists(a, b) {\n    var cursor1 = a.head;\n    var cursor2 = b.head;\n\n    while (cursor1 && cursor2 && cursor1.data.id === cursor2.data.id) {\n        cursor1 = cursor1.next;\n        cursor2 = cursor2.next;\n    }\n\n    return cursor1 === null && cursor2 === null;\n}\n\nfunction isEqualDeclarations(a, b) {\n    var cursor1 = a.head;\n    var cursor2 = b.head;\n\n    while (cursor1 && cursor2 && cursor1.data.id === cursor2.data.id) {\n        cursor1 = cursor1.next;\n        cursor2 = cursor2.next;\n    }\n\n    return cursor1 === null && cursor2 === null;\n}\n\nfunction compareDeclarations(declarations1, declarations2) {\n    var result = {\n        eq: [],\n        ne1: [],\n        ne2: [],\n        ne2overrided: []\n    };\n\n    var fingerprints = Object.create(null);\n    var declarations2hash = Object.create(null);\n\n    for (var cursor = declarations2.head; cursor; cursor = cursor.next)  {\n        declarations2hash[cursor.data.id] = true;\n    }\n\n    for (var cursor = declarations1.head; cursor; cursor = cursor.next)  {\n        var data = cursor.data;\n\n        if (data.fingerprint) {\n            fingerprints[data.fingerprint] = data.value.important;\n        }\n\n        if (declarations2hash[data.id]) {\n            declarations2hash[data.id] = false;\n            result.eq.push(data);\n        } else {\n            result.ne1.push(data);\n        }\n    }\n\n    for (var cursor = declarations2.head; cursor; cursor = cursor.next)  {\n        var data = cursor.data;\n\n        if (declarations2hash[data.id]) {\n            // if declarations1 has overriding declaration, this is not a difference\n            // but take in account !important - prev should be equal or greater than follow\n            if (hasOwnProperty.call(fingerprints, data.fingerprint) &&\n                Number(fingerprints[data.fingerprint]) >= Number(data.value.important)) {\n                result.ne2overrided.push(data);\n            } else {\n                result.ne2.push(data);\n            }\n        }\n    }\n\n    return result;\n}\n\nfunction addSelectors(dest, source) {\n    source.each(function(sourceData) {\n        var newStr = sourceData.id;\n        var cursor = dest.head;\n\n        while (cursor) {\n            var nextStr = cursor.data.id;\n\n            if (nextStr === newStr) {\n                return;\n            }\n\n            if (nextStr > newStr) {\n                break;\n            }\n\n            cursor = cursor.next;\n        }\n\n        dest.insert(dest.createItem(sourceData), cursor);\n    });\n\n    return dest;\n}\n\n// check if simpleselectors has no equal specificity and element selector\nfunction hasSimilarSelectors(selectors1, selectors2) {\n    return selectors1.some(function(a) {\n        return selectors2.some(function(b) {\n            return a.compareMarker === b.compareMarker;\n        });\n    });\n}\n\n// test node can't to be skipped\nfunction unsafeToSkipNode(node) {\n    switch (node.type) {\n        case 'Ruleset':\n            // unsafe skip ruleset with selector similarities\n            return hasSimilarSelectors(node.selector.selectors, this);\n\n        case 'Atrule':\n            // can skip at-rules with blocks\n            if (node.block) {\n                // non-stylesheet blocks are safe to skip since have no selectors\n                if (node.block.type !== 'StyleSheet') {\n                    return false;\n                }\n\n                // unsafe skip at-rule if block contains something unsafe to skip\n                return node.block.rules.some(unsafeToSkipNode, this);\n            }\n            break;\n    }\n\n    // unsafe by default\n    return true;\n}\n\nmodule.exports = {\n    isEqualLists: isEqualLists,\n    isEqualDeclarations: isEqualDeclarations,\n    compareDeclarations: compareDeclarations,\n    addSelectors: addSelectors,\n    hasSimilarSelectors: hasSimilarSelectors,\n    unsafeToSkipNode: unsafeToSkipNode\n};\n"]}