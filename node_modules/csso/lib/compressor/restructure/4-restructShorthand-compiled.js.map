{"version":3,"sources":["4-restructShorthand.js"],"names":[],"mappings":"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","file":"4-restructShorthand-compiled.js","sourcesContent":["var List = require('../../utils/list.js');\nvar translate = require('../ast/translate.js');\nvar internalWalkRulesRight = require('../ast/walk.js').rulesRight;\n\nvar REPLACE = 1;\nvar REMOVE = 2;\nvar TOP = 0;\nvar RIGHT = 1;\nvar BOTTOM = 2;\nvar LEFT = 3;\nvar SIDES = ['top', 'right', 'bottom', 'left'];\nvar SIDE = {\n    'margin-top': 'top',\n    'margin-right': 'right',\n    'margin-bottom': 'bottom',\n    'margin-left': 'left',\n\n    'padding-top': 'top',\n    'padding-right': 'right',\n    'padding-bottom': 'bottom',\n    'padding-left': 'left',\n\n    'border-top-color': 'top',\n    'border-right-color': 'right',\n    'border-bottom-color': 'bottom',\n    'border-left-color': 'left',\n    'border-top-width': 'top',\n    'border-right-width': 'right',\n    'border-bottom-width': 'bottom',\n    'border-left-width': 'left',\n    'border-top-style': 'top',\n    'border-right-style': 'right',\n    'border-bottom-style': 'bottom',\n    'border-left-style': 'left'\n};\nvar MAIN_PROPERTY = {\n    'margin': 'margin',\n    'margin-top': 'margin',\n    'margin-right': 'margin',\n    'margin-bottom': 'margin',\n    'margin-left': 'margin',\n\n    'padding': 'padding',\n    'padding-top': 'padding',\n    'padding-right': 'padding',\n    'padding-bottom': 'padding',\n    'padding-left': 'padding',\n\n    'border-color': 'border-color',\n    'border-top-color': 'border-color',\n    'border-right-color': 'border-color',\n    'border-bottom-color': 'border-color',\n    'border-left-color': 'border-color',\n    'border-width': 'border-width',\n    'border-top-width': 'border-width',\n    'border-right-width': 'border-width',\n    'border-bottom-width': 'border-width',\n    'border-left-width': 'border-width',\n    'border-style': 'border-style',\n    'border-top-style': 'border-style',\n    'border-right-style': 'border-style',\n    'border-bottom-style': 'border-style',\n    'border-left-style': 'border-style'\n};\n\nfunction TRBL(name) {\n    this.name = name;\n    this.info = null;\n    this.iehack = undefined;\n    this.sides = {\n        'top': null,\n        'right': null,\n        'bottom': null,\n        'left': null\n    };\n}\n\nTRBL.prototype.getValueSequence = function(value, count) {\n    var values = [];\n    var iehack = false;\n    var hasBadValues = value.sequence.some(function(child) {\n        var special = false;\n\n        switch (child.type) {\n            case 'Identifier':\n                switch (child.name) {\n                    case '\\\\9':\n                        iehack = true;\n                        return;\n\n                    case 'inherit':\n                    case 'initial':\n                    case 'unset':\n                    case 'revert':\n                        special = child.name;\n                        break;\n                }\n                break;\n\n            case 'Dimension':\n                switch (child.unit) {\n                    // is not supported until IE11\n                    case 'rem':\n\n                    // v* units is too buggy across browsers and better\n                    // don't merge values with those units\n                    case 'vw':\n                    case 'vh':\n                    case 'vmin':\n                    case 'vmax':\n                    case 'vm': // IE9 supporting \"vm\" instead of \"vmin\".\n                        special = child.unit;\n                        break;\n                }\n                break;\n\n            case 'Number':\n            case 'Percentage':\n                break;\n\n            case 'Space':\n                return false; // ignore space\n\n            default:\n                return true;  // bad value\n        }\n\n        values.push({\n            node: child,\n            special: special,\n            important: value.important\n        });\n    });\n\n    if (hasBadValues || values.length > count) {\n        return false;\n    }\n\n    if (typeof this.iehack === 'boolean' && this.iehack !== iehack) {\n        return false;\n    }\n\n    this.iehack = iehack; // move outside\n\n    return values;\n};\n\nTRBL.prototype.canOverride = function(side, value) {\n    var currentValue = this.sides[side];\n\n    return !currentValue || (value.important && !currentValue.important);\n};\n\nTRBL.prototype.add = function(name, value, info) {\n    function attemptToAdd() {\n        var sides = this.sides;\n        var side = SIDE[name];\n\n        if (side) {\n            if (side in sides) {\n                var values = this.getValueSequence(value, 1);\n\n                if (!values || !values.length) {\n                    return false;\n                }\n\n                // can mix only if specials are equal\n                for (var key in sides) {\n                    if (sides[key] !== null && sides[key].special !== values[0].special) {\n                        return false;\n                    }\n                }\n\n                if (!this.canOverride(side, values[0])) {\n                    return true;\n                }\n\n                sides[side] = values[0];\n                return true;\n            }\n        } else if (name === this.name) {\n            var values = this.getValueSequence(value, 4);\n\n            if (!values || !values.length) {\n                return false;\n            }\n\n            switch (values.length) {\n                case 1:\n                    values[RIGHT] = values[TOP];\n                    values[BOTTOM] = values[TOP];\n                    values[LEFT] = values[TOP];\n                    break;\n\n                case 2:\n                    values[BOTTOM] = values[TOP];\n                    values[LEFT] = values[RIGHT];\n                    break;\n\n                case 3:\n                    values[LEFT] = values[RIGHT];\n                    break;\n            }\n\n            // can mix only if specials are equal\n            for (var i = 0; i < 4; i++) {\n                for (var key in sides) {\n                    if (sides[key] !== null && sides[key].special !== values[i].special) {\n                        return false;\n                    }\n                }\n            }\n\n            for (var i = 0; i < 4; i++) {\n                if (this.canOverride(SIDES[i], values[i])) {\n                    sides[SIDES[i]] = values[i];\n                }\n            }\n\n            return true;\n        }\n    }\n\n    if (!attemptToAdd.call(this)) {\n        return false;\n    }\n\n    if (this.info) {\n        this.info = {\n            primary: this.info,\n            merged: info\n        };\n    } else {\n        this.info = info;\n    }\n\n    return true;\n};\n\nTRBL.prototype.isOkToMinimize = function() {\n    var top = this.sides.top;\n    var right = this.sides.right;\n    var bottom = this.sides.bottom;\n    var left = this.sides.left;\n\n    if (top && right && bottom && left) {\n        var important =\n            top.important +\n            right.important +\n            bottom.important +\n            left.important;\n\n        return important === 0 || important === 4;\n    }\n\n    return false;\n};\n\nTRBL.prototype.getValue = function() {\n    var result = [];\n    var sides = this.sides;\n    var values = [\n        sides.top,\n        sides.right,\n        sides.bottom,\n        sides.left\n    ];\n    var stringValues = [\n        translate(sides.top.node),\n        translate(sides.right.node),\n        translate(sides.bottom.node),\n        translate(sides.left.node)\n    ];\n\n    if (stringValues[LEFT] === stringValues[RIGHT]) {\n        values.pop();\n        if (stringValues[BOTTOM] === stringValues[TOP]) {\n            values.pop();\n            if (stringValues[RIGHT] === stringValues[TOP]) {\n                values.pop();\n            }\n        }\n    }\n\n    for (var i = 0; i < values.length; i++) {\n        if (i) {\n            result.push({ type: 'Space' });\n        }\n\n        result.push(values[i].node);\n    }\n\n    if (this.iehack) {\n        result.push({ type: 'Space' }, {\n            type: 'Identifier',\n            info: {},\n            name: '\\\\9'\n        });\n    }\n\n    return {\n        type: 'Value',\n        info: {},\n        important: sides.top.important,\n        sequence: new List(result)\n    };\n};\n\nTRBL.prototype.getProperty = function() {\n    return {\n        type: 'Property',\n        info: {},\n        name: this.name\n    };\n};\n\nfunction processRuleset(ruleset, shorts, shortDeclarations, lastShortSelector) {\n    var declarations = ruleset.block.declarations;\n    var selector = ruleset.selector.selectors.first().id;\n\n    ruleset.block.declarations.eachRight(function(declaration, item) {\n        var property = declaration.property.name;\n\n        if (!MAIN_PROPERTY.hasOwnProperty(property)) {\n            return;\n        }\n\n        var key = MAIN_PROPERTY[property];\n        var shorthand;\n        var operation;\n\n        if (!lastShortSelector || selector === lastShortSelector) {\n            if (key in shorts) {\n                operation = REMOVE;\n                shorthand = shorts[key];\n            }\n        }\n\n        if (!shorthand || !shorthand.add(property, declaration.value, declaration.info)) {\n            operation = REPLACE;\n            shorthand = new TRBL(key);\n            shorthand.add(property, declaration.value, declaration.info);\n        }\n\n        shorts[key] = shorthand;\n        shortDeclarations.push({\n            operation: operation,\n            block: declarations,\n            item: item,\n            shorthand: shorthand\n        });\n\n        lastShortSelector = selector;\n    });\n\n    return lastShortSelector;\n};\n\nfunction processShorthands(shortDeclarations, markDeclaration) {\n    shortDeclarations.forEach(function(item) {\n        var shorthand = item.shorthand;\n\n        if (!shorthand.isOkToMinimize()) {\n            return;\n        }\n\n        if (item.operation === REPLACE) {\n            item.item.data = markDeclaration({\n                type: 'Declaration',\n                info: shorthand.info,\n                property: shorthand.getProperty(),\n                value: shorthand.getValue(),\n                id: 0,\n                length: 0,\n                fingerprint: null\n            });\n        } else {\n            item.block.remove(item.item);\n        }\n    });\n};\n\nmodule.exports = function restructBlock(ast, indexer) {\n    var stylesheetMap = {};\n    var shortDeclarations = [];\n\n    internalWalkRulesRight(ast, function(node) {\n        if (node.type !== 'Ruleset') {\n            return;\n        }\n\n        var stylesheet = this.stylesheet;\n        var rulesetId = (node.pseudoSignature || '') + '|' + node.selector.selectors.first().id;\n        var rulesetMap;\n        var shorts;\n\n        if (!stylesheetMap.hasOwnProperty(stylesheet.id)) {\n            rulesetMap = {\n                lastShortSelector: null\n            };\n            stylesheetMap[stylesheet.id] = rulesetMap;\n        } else {\n            rulesetMap = stylesheetMap[stylesheet.id];\n        }\n\n        if (rulesetMap.hasOwnProperty(rulesetId)) {\n            shorts = rulesetMap[rulesetId];\n        } else {\n            shorts = {};\n            rulesetMap[rulesetId] = shorts;\n        }\n\n        rulesetMap.lastShortSelector = processRuleset.call(this, node, shorts, shortDeclarations, rulesetMap.lastShortSelector);\n    });\n\n    processShorthands(shortDeclarations, indexer.declaration);\n};\n"]}